<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-11">

<title>IS415-GAA - Hands-on Exercise 9: Geographical Segmentation with Spatially Constrained Clustering Techniques</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex01/hands-on_ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex03/hands-on_ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex04/hands-on_ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex06/hands-on_ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex07/hands-on_ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex08/hands-on_ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex09/hands-on_ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/hands-on_ex10/hands-on_ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex02/in-class_ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex03/in-class_ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex04/in-class_ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex05/in-class_ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex06/in-class_ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex07/in-class_ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex08/in-class_ex08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/in-class_ex09/in-class_ex09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../take_home_ex/take_home_ex01/take_home_ex01.html">
 <span class="dropdown-text">Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../take_home_ex/take_home_ex02/take_home_ex02.html">
 <span class="dropdown-text">Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-shiny-workshop" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Shiny Workshop</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-shiny-workshop">    
        <li>
    <a class="dropdown-item" href="../../prototype/01-prototype/app.R">
 <span class="dropdown-text">Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../prototype/02-prototype/app.R">
 <span class="dropdown-text">Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../prototype/03-prototype/app.R">
 <span class="dropdown-text">Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../prototype/04-prototype/app.R">
 <span class="dropdown-text">Exercise 4</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1.0 Overview</a>
  <ul class="collapse">
  <li><a href="#the-analytical-question" id="toc-the-analytical-question" class="nav-link" data-scroll-target="#the-analytical-question">1.1 The analytical question</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">1.2 The Data</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">1.3 Load Packages</a></li>
  </ul></li>
  <li><a href="#data-import-and-preparation" id="toc-data-import-and-preparation" class="nav-link" data-scroll-target="#data-import-and-preparation">2.0 Data Import and Preparation</a>
  <ul class="collapse">
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data">2.1 Geospatial Data</a></li>
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">2.2 Aspatial Data</a></li>
  <li><a href="#derive-new-variables" id="toc-derive-new-variables" class="nav-link" data-scroll-target="#derive-new-variables">2.3 Derive new variables</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">3.0 Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
  <li><a href="#eda-using-statistical-graphics" id="toc-eda-using-statistical-graphics" class="nav-link" data-scroll-target="#eda-using-statistical-graphics">3.1 EDA using statistical graphics</a></li>
  <li><a href="#eda-using-choropleth-map" id="toc-eda-using-choropleth-map" class="nav-link" data-scroll-target="#eda-using-choropleth-map">3.2 EDA using choropleth map</a>
  <ul class="collapse">
  <li><a href="#join-geospatial-and-aspatial-data" id="toc-join-geospatial-and-aspatial-data" class="nav-link" data-scroll-target="#join-geospatial-and-aspatial-data">3.2.1 Join geospatial and aspatial data</a></li>
  <li><a href="#preparing-a-choropleth-map" id="toc-preparing-a-choropleth-map" class="nav-link" data-scroll-target="#preparing-a-choropleth-map">3.2.2 Preparing a choropleth map</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">4.0 Correlation Analysis</a></li>
  <li><a href="#hierarchy-cluster-analysis" id="toc-hierarchy-cluster-analysis" class="nav-link" data-scroll-target="#hierarchy-cluster-analysis">5.0 Hierarchy Cluster Analysis</a>
  <ul class="collapse">
  <li><a href="#extracting-clustering-variables" id="toc-extracting-clustering-variables" class="nav-link" data-scroll-target="#extracting-clustering-variables">5.1 Extracting clustering variables</a></li>
  <li><a href="#data-standardisation" id="toc-data-standardisation" class="nav-link" data-scroll-target="#data-standardisation">5.2 Data Standardisation</a>
  <ul class="collapse">
  <li><a href="#min-max-standardisation" id="toc-min-max-standardisation" class="nav-link" data-scroll-target="#min-max-standardisation">5.2.1 Min-Max standardisation</a></li>
  <li><a href="#z-score-standardisation" id="toc-z-score-standardisation" class="nav-link" data-scroll-target="#z-score-standardisation">5.2.2 Z-score standardisation</a></li>
  <li><a href="#visualising-the-standardised-clustering-variables" id="toc-visualising-the-standardised-clustering-variables" class="nav-link" data-scroll-target="#visualising-the-standardised-clustering-variables">5.2.3 Visualising the standardised clustering variables</a></li>
  </ul></li>
  <li><a href="#computing-proximity-matrix" id="toc-computing-proximity-matrix" class="nav-link" data-scroll-target="#computing-proximity-matrix">5.3 Computing proximity matrix</a></li>
  <li><a href="#computing-hierarchical-clustering" id="toc-computing-hierarchical-clustering" class="nav-link" data-scroll-target="#computing-hierarchical-clustering">5.4 Computing hierarchical clustering</a>
  <ul class="collapse">
  <li><a href="#perform-hierarchical-cluster-analysis" id="toc-perform-hierarchical-cluster-analysis" class="nav-link" data-scroll-target="#perform-hierarchical-cluster-analysis">5.4.1 Perform hierarchical cluster analysis</a></li>
  <li><a href="#select-optimal-clustering-algorithm" id="toc-select-optimal-clustering-algorithm" class="nav-link" data-scroll-target="#select-optimal-clustering-algorithm">5.4.2 Select Optimal clustering algorithm</a></li>
  <li><a href="#determining-optimal-clusters" id="toc-determining-optimal-clusters" class="nav-link" data-scroll-target="#determining-optimal-clusters">5.4.3 Determining Optimal Clusters</a></li>
  <li><a href="#interpreting-the-dendrograms" id="toc-interpreting-the-dendrograms" class="nav-link" data-scroll-target="#interpreting-the-dendrograms">5.4.4 Interpreting the dendrograms</a></li>
  <li><a href="#visually-driven-hierarchical-clustering-analysis" id="toc-visually-driven-hierarchical-clustering-analysis" class="nav-link" data-scroll-target="#visually-driven-hierarchical-clustering-analysis">5.4.5 Visually-driven hierarchical clustering analysis</a></li>
  <li><a href="#mapping-the-clusters-formed" id="toc-mapping-the-clusters-formed" class="nav-link" data-scroll-target="#mapping-the-clusters-formed">5.4.6 Mapping the clusters formed</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#spatially-constrained-clustering-skater-approach" id="toc-spatially-constrained-clustering-skater-approach" class="nav-link" data-scroll-target="#spatially-constrained-clustering-skater-approach">6.0 Spatially Constrained Clustering: SKATER approach</a>
  <ul class="collapse">
  <li><a href="#converting-into-spatialpolygonsdataframe" id="toc-converting-into-spatialpolygonsdataframe" class="nav-link" data-scroll-target="#converting-into-spatialpolygonsdataframe">6.1 Converting into SpatialPolygonsDataFrame</a></li>
  <li><a href="#computing-neighbour-list" id="toc-computing-neighbour-list" class="nav-link" data-scroll-target="#computing-neighbour-list">6.2 Computing Neighbour List</a></li>
  <li><a href="#computing-minimum-spanning-tree" id="toc-computing-minimum-spanning-tree" class="nav-link" data-scroll-target="#computing-minimum-spanning-tree">6.3 Computing minimum spanning tree</a>
  <ul class="collapse">
  <li><a href="#calculating-edge-costs" id="toc-calculating-edge-costs" class="nav-link" data-scroll-target="#calculating-edge-costs">6.3.1 Calculating edge costs</a></li>
  <li><a href="#computing-minimum-spanning-tree-1" id="toc-computing-minimum-spanning-tree-1" class="nav-link" data-scroll-target="#computing-minimum-spanning-tree-1">6.3.2 Computing minimum spanning tree</a></li>
  </ul></li>
  <li><a href="#computing-spatially-constrained-clusters-using-skater-method" id="toc-computing-spatially-constrained-clusters-using-skater-method" class="nav-link" data-scroll-target="#computing-spatially-constrained-clusters-using-skater-method">6.4 Computing spatially constrained clusters using SKATER method</a></li>
  <li><a href="#visualising-the-clusters-in-choropleth-map" id="toc-visualising-the-clusters-in-choropleth-map" class="nav-link" data-scroll-target="#visualising-the-clusters-in-choropleth-map">6.5 Visualising the clusters in choropleth map</a></li>
  </ul></li>
  <li><a href="#spatially-constrained-clustering-clustgeo-method" id="toc-spatially-constrained-clustering-clustgeo-method" class="nav-link" data-scroll-target="#spatially-constrained-clustering-clustgeo-method">7.0 Spatially Constrained Clustering: ClustGeo Method</a>
  <ul class="collapse">
  <li><a href="#ward-like-hierarchical-clustering-clustgeo" id="toc-ward-like-hierarchical-clustering-clustgeo" class="nav-link" data-scroll-target="#ward-like-hierarchical-clustering-clustgeo">7.1 Ward-like hierarchical clustering: ClustGeo</a>
  <ul class="collapse">
  <li><a href="#mapping-the-clusters-formed-1" id="toc-mapping-the-clusters-formed-1" class="nav-link" data-scroll-target="#mapping-the-clusters-formed-1">7.1.1 Mapping the clusters formed</a></li>
  </ul></li>
  <li><a href="#spatially-constrained-hierarchical-clustering" id="toc-spatially-constrained-hierarchical-clustering" class="nav-link" data-scroll-target="#spatially-constrained-hierarchical-clustering">7.2 Spatially Constrained Hierarchical Clustering</a></li>
  </ul></li>
  <li><a href="#visual-interpretation-of-clusters" id="toc-visual-interpretation-of-clusters" class="nav-link" data-scroll-target="#visual-interpretation-of-clusters">8.0 Visual Interpretation of Clusters</a>
  <ul class="collapse">
  <li><a href="#visualising-individual-clustering-variable" id="toc-visualising-individual-clustering-variable" class="nav-link" data-scroll-target="#visualising-individual-clustering-variable">8.1 Visualising individual clustering variable</a></li>
  <li><a href="#multivariate-visualisation" id="toc-multivariate-visualisation" class="nav-link" data-scroll-target="#multivariate-visualisation">8.2 Multivariate Visualisation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hands-on Exercise 9: Geographical Segmentation with Spatially Constrained Clustering Techniques</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 11, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 12, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1.0 Overview</h1>
<p>To do -</p>
<ul>
<li><p>hierarchical cluster analysis; and</p></li>
<li><p>spatially constrained cluster analysis.</p></li>
</ul>
<section id="the-analytical-question" class="level2">
<h2 class="anchored" data-anchor-id="the-analytical-question">1.1 The analytical question</h2>
<p>In geobusiness and spatial policy, it is a common practice to delineate the market or planning area into homogeneous regions by using multivariate data. In this hands-on exercise, we are interested to delineate <a href="https://en.wikipedia.org/wiki/Shan_State">Shan State</a>, <a href="https://en.wikipedia.org/wiki/Myanmar">Myanmar</a> into homogeneous regions by using multiple Information and Communication technology (ICT) measures, namely: Radio, Television, Land line phone, Mobile phone, Computer, and Internet at home.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">1.2 The Data</h2>
<ul>
<li><p>Myanmar Township Boundary Data (i.e.&nbsp;<em>myanmar_township_boundaries</em>) : This is a GIS data in ESRI shapefile format. It consists of township boundary information of Myanmar. The spatial data are captured in polygon features.</p></li>
<li><p><em>Shan-ICT.csv</em>: This is an extract of <a href="https://myanmar.unfpa.org/en/publications/2014-population-and-housing-census-myanmar-data-sheet"><strong>The 2014 Myanmar Population and Housing Census Myanmar</strong></a> at the township level.</p></li>
</ul>
</section>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">1.3 Load Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rgdal, spdep, tmap, sf, ClustGeo, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, cluster, factoextra, NbClust,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               heatmaply, corrplot, psych, tidyverse, GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-import-and-preparation" class="level1">
<h1>2.0 Data Import and Preparation</h1>
<section id="geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data">2.1 Geospatial Data</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">View</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Glimpse</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"mmr_polbnda_adm3_250k_mimu"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Shan (East)"</span>, <span class="st">"Shan (North)"</span>, <span class="st">"Shan (South)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm3_250k_mimu' from data source 
  `/Users/shambhavigoenka/Desktop/School/Geo/IS415-GAA/hands-on_ex/hands-on_ex09/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 330 features and 9 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>shan_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 55 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 96.15107 ymin: 19.29932 xmax: 101.17 ymax: 24.15907
Geodetic CRS:  WGS 84
First 10 features:
             ST ST_PCODE        DT   DT_PCODE        TS  TS_PCODE
1   Shan (East)   MMR016  Monghsat MMR016D002  Monghsat MMR016006
2   Shan (East)   MMR016  Monghsat MMR016D002   Mongton MMR016008
3   Shan (East)   MMR016 Tachileik MMR016D003 Monghpyak MMR016010
4   Shan (East)   MMR016 Tachileik MMR016D003 Mongyawng MMR016011
5   Shan (East)   MMR016 Tachileik MMR016D003 Tachileik MMR016009
6  Shan (North)   MMR015    Hopang MMR015D006    Hopang MMR015021
7  Shan (North)   MMR015    Hopang MMR015D006   Mongmao MMR015008
8  Shan (North)   MMR015    Lashio MMR015D001   Mongyai MMR015003
9  Shan (North)   MMR015    Lashio MMR015D001   Tangyan MMR015004
10 Shan (North)   MMR015    Matman MMR015D007    Matman MMR015024
                         geometry
1  MULTIPOLYGON (((99.17944 20...
2  MULTIPOLYGON (((98.50567 20...
3  MULTIPOLYGON (((100.0708 21...
4  MULTIPOLYGON (((101.1053 21...
5  MULTIPOLYGON (((100.3687 21...
6  MULTIPOLYGON (((98.88008 23...
7  MULTIPOLYGON (((98.94264 23...
8  MULTIPOLYGON (((98.04246 22...
9  MULTIPOLYGON (((98.27834 22...
10 MULTIPOLYGON (((98.9057 22....</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(shan_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 55
Columns: 7
$ ST       &lt;chr&gt; "Shan (East)", "Shan (East)", "Shan (East)", "Shan (East)", "…
$ ST_PCODE &lt;chr&gt; "MMR016", "MMR016", "MMR016", "MMR016", "MMR016", "MMR015", "…
$ DT       &lt;chr&gt; "Monghsat", "Monghsat", "Tachileik", "Tachileik", "Tachileik"…
$ DT_PCODE &lt;chr&gt; "MMR016D002", "MMR016D002", "MMR016D003", "MMR016D003", "MMR0…
$ TS       &lt;chr&gt; "Monghsat", "Mongton", "Monghpyak", "Mongyawng", "Tachileik",…
$ TS_PCODE &lt;chr&gt; "MMR016006", "MMR016008", "MMR016010", "MMR016011", "MMR01600…
$ geometry &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((99.17944 20..., MULTIPOLYGON (((…</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="aspatial-data" class="level2">
<h2 class="anchored" data-anchor-id="aspatial-data">2.2 Aspatial Data</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Import</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ict <span class="ot">&lt;-</span> <span class="fu">read_csv</span> (<span class="st">"data/aspatial/censuscommuniationtsp.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(name_st <span class="sc">==</span> <span class="st">"Shan"</span>) <span class="sc">%&gt;%</span> <span class="co">#Filter Shan district values</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="co">#Remove district columns</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">`</span><span class="at">District Pcode</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"pcode_dt"</span>, <span class="co">#Rename columns</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">District Name</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"name_dt"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Township Pcode</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"pcode_ts"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Township Name</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"name_ts"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Total households</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"com_t"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Radio</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"com_radio"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Television</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"com_tv"</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"com_lline"</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"com_mob"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Computer</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"com_comp"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"com_int"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> District Pcode     District Name      Township Pcode     Township Name     
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 Total households     Radio         Television    Land line phone
 Min.   : 3318    Min.   :  148   Min.   :  728   Min.   :  20   
 1st Qu.:10791    1st Qu.: 1462   1st Qu.: 4837   1st Qu.: 351   
 Median :16332    Median : 2891   Median : 7407   Median : 695   
 Mean   :21265    Mean   : 4954   Mean   :11615   Mean   :1037   
 3rd Qu.:32152    3rd Qu.: 7417   3rd Qu.:15402   3rd Qu.:1232   
 Max.   :94869    Max.   :32301   Max.   :68277   Max.   :6981   
  Mobile phone      Computer      Internet at home
 Min.   :  150   Min.   :  20.0   Min.   :   8.0  
 1st Qu.: 2326   1st Qu.: 152.0   1st Qu.: 142.5  
 Median : 4439   Median : 252.0   Median : 321.0  
 Mean   : 7321   Mean   : 615.6   Mean   : 829.4  
 3rd Qu.: 9802   3rd Qu.: 562.5   3rd Qu.: 723.5  
 Max.   :50760   Max.   :6796.0   Max.   :9960.0  </code></pre>
</div>
</div>
<p>There are a total of eleven fields and 55 observation in the tibble data.frame.</p>
</div>
</div>
</div>
</section>
<section id="derive-new-variables" class="level2">
<h2 class="anchored" data-anchor-id="derive-new-variables">2.3 Derive new variables</h2>
<p>Use penetration rate (%) instead of absolute values to reduce bias</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Derive</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Radio</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Television</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Computer</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">DT_PCODE</span><span class="st">`</span> <span class="ot">=</span><span class="st">`</span><span class="at">District Pcode</span><span class="st">`</span>,<span class="st">`</span><span class="at">DT</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">District Name</span><span class="st">`</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS_PCODE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Pcode</span><span class="st">`</span>, <span class="st">`</span><span class="at">TS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Name</span><span class="st">`</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TT_HOUSEHOLDS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Radio</span><span class="st">`</span>, <span class="st">`</span><span class="at">TV</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Television</span><span class="st">`</span>, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span>, <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Computer</span><span class="st">`</span>, <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict_derived)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   DT_PCODE              DT              TS_PCODE              TS           
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 TT_HOUSEHOLDS       RADIO             TV           LLPHONE         MPHONE     
 Min.   : 3318   Min.   :  148   Min.   :  728   Min.   :  20   Min.   :  150  
 1st Qu.:10791   1st Qu.: 1462   1st Qu.: 4837   1st Qu.: 351   1st Qu.: 2326  
 Median :16332   Median : 2891   Median : 7407   Median : 695   Median : 4439  
 Mean   :21265   Mean   : 4954   Mean   :11615   Mean   :1037   Mean   : 7321  
 3rd Qu.:32152   3rd Qu.: 7417   3rd Qu.:15402   3rd Qu.:1232   3rd Qu.: 9802  
 Max.   :94869   Max.   :32301   Max.   :68277   Max.   :6981   Max.   :50760  
    COMPUTER         INTERNET         RADIO_PR          TV_PR      
 Min.   :  20.0   Min.   :   8.0   Min.   : 15.31   Min.   :116.0  
 1st Qu.: 152.0   1st Qu.: 142.5   1st Qu.:131.31   1st Qu.:414.1  
 Median : 252.0   Median : 321.0   Median :199.94   Median :525.1  
 Mean   : 615.6   Mean   : 829.4   Mean   :209.64   Mean   :502.8  
 3rd Qu.: 562.5   3rd Qu.: 723.5   3rd Qu.:258.53   3rd Qu.:598.4  
 Max.   :6796.0   Max.   :9960.0   Max.   :484.52   Max.   :790.5  
   LLPHONE_PR       MPHONE_PR       COMPUTER_PR      INTERNET_PR     
 Min.   :  2.78   Min.   : 36.42   Min.   : 3.278   Min.   :  1.041  
 1st Qu.: 23.17   1st Qu.:169.37   1st Qu.:11.256   1st Qu.:  8.617  
 Median : 35.31   Median :285.53   Median :15.765   Median : 20.417  
 Mean   : 47.61   Mean   :310.33   Mean   :22.921   Mean   : 28.727  
 3rd Qu.: 68.06   3rd Qu.:436.35   3rd Qu.:29.058   3rd Qu.: 39.925  
 Max.   :181.49   Max.   :709.77   Max.   :79.606   Max.   :113.287  </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level1">
<h1>3.0 Exploratory Data Analysis (EDA)</h1>
<section id="eda-using-statistical-graphics" class="level2">
<h2 class="anchored" data-anchor-id="eda-using-statistical-graphics">3.1 EDA using statistical graphics</h2>
<p><strong>View for Radio</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Distribution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>To visualise outliers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p><strong>View for Radio Penetration Rate</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Distribution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>To visualise outliers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p><strong>View All</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio, tv, llphone, mphone, computer, internet, </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="eda-using-choropleth-map" class="level2">
<h2 class="anchored" data-anchor-id="eda-using-choropleth-map">3.2 EDA using choropleth map</h2>
<section id="join-geospatial-and-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="join-geospatial-and-aspatial-data">3.2.1 Join geospatial and aspatial data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shan_sf, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                     ict_derived, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"TS_PCODE"</span><span class="ot">=</span><span class="st">"TS_PCODE"</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#store</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(shan_sf, <span class="st">"data/rds/shan_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Store as rds</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/shan_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-a-choropleth-map" class="level3">
<h3 class="anchored" data-anchor-id="preparing-a-choropleth-map">3.2.2 Preparing a choropleth map</h3>
<p>Quantile mapping</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf, <span class="st">"RADIO_PR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>View comparison</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>TT_HOUSEHOLDS.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"TT_HOUSEHOLDS"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total households"</span>) <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>RADIO.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"RADIO"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Number Radio "</span>) <span class="sc">+</span> </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TT_HOUSEHOLDS.map, RADIO.map,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Townships with relatively larger number of households are also showing relatively higher number of radio ownership.</p>
<p>Use jenks breaks</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shan_sf) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="fu">c</span>(<span class="st">"TT_HOUSEHOLDS"</span>, <span class="st">"RADIO_PR"</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">style=</span><span class="st">"jenks"</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_facets</span>(<span class="at">sync =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))<span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">outer.margins=</span><span class="dv">0</span>, <span class="at">asp=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Maps have less colour variation - data is more evenly distributed</p>
</section>
</section>
</section>
<section id="correlation-analysis" class="level1">
<h1>4.0 Correlation Analysis</h1>
<p>Check for multicollinearity</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>cluster_vars.cor <span class="ot">=</span> <span class="fu">cor</span>(ict_derived[,<span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>])</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cluster_vars.cor,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>COMPUTER_PR and INTERNET_PR are highly correlated</p>
</section>
<section id="hierarchy-cluster-analysis" class="level1">
<h1>5.0 Hierarchy Cluster Analysis</h1>
<section id="extracting-clustering-variables" class="level2">
<h2 class="anchored" data-anchor-id="extracting-clustering-variables">5.1 Extracting clustering variables</h2>
<p>Exclude INTERNET_PR due to high correlation with COMPUTER_PR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> shan_sf <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"TS.x"</span>, <span class="st">"RADIO_PR"</span>, <span class="st">"TV_PR"</span>, <span class="st">"LLPHONE_PR"</span>, <span class="st">"MPHONE_PR"</span>, <span class="st">"COMPUTER_PR"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
1   Monghsat 119.2507 425.9850  31.081576 173.72194   19.726859
2    Mongton 130.5008 339.5895  31.067806 173.38871   13.816788
3  Monghpyak 405.0284 503.3252  42.497972 381.83293   25.141930
4  Mongyawng 140.7886 676.7271  91.358455 556.87369   13.782275
5  Tachileik 365.7527 722.7723  58.662703 678.33727   79.606084
6     Hopang 127.6748 555.2782  94.418688 452.74608   22.467903
7    Mongmao 120.0574 512.6855  85.495452 424.98803   11.297271
8    Mongyai 168.4424 364.2707  20.333133 135.12905    9.378752
9    Tangyan 223.8632 453.2753  22.594047 105.23021   12.065335
10    Matman 244.1230 219.4093   8.438819  45.20796    6.027728</code></pre>
</div>
</div>
<p>Change index to township name</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(cluster_vars) <span class="ot">&lt;-</span> cluster_vars<span class="sc">$</span><span class="st">"TS.x"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               TS.x RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Monghsat   Monghsat 119.2507 425.9850  31.081576 173.72194   19.726859
Mongton     Mongton 130.5008 339.5895  31.067806 173.38871   13.816788
Monghpyak Monghpyak 405.0284 503.3252  42.497972 381.83293   25.141930
Mongyawng Mongyawng 140.7886 676.7271  91.358455 556.87369   13.782275
Tachileik Tachileik 365.7527 722.7723  58.662703 678.33727   79.606084
Hopang       Hopang 127.6748 555.2782  94.418688 452.74608   22.467903
Mongmao     Mongmao 120.0574 512.6855  85.495452 424.98803   11.297271
Mongyai     Mongyai 168.4424 364.2707  20.333133 135.12905    9.378752
Tangyan     Tangyan 223.8632 453.2753  22.594047 105.23021   12.065335
Matman       Matman 244.1230 219.4093   8.438819  45.20796    6.027728</code></pre>
</div>
</div>
<p>Remove duplicate column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>shan_ict <span class="ot">&lt;-</span> <span class="fu">select</span>(cluster_vars, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan_ict, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Monghsat  119.2507 425.9850  31.081576 173.72194   19.726859
Mongton   130.5008 339.5895  31.067806 173.38871   13.816788
Monghpyak 405.0284 503.3252  42.497972 381.83293   25.141930
Mongyawng 140.7886 676.7271  91.358455 556.87369   13.782275
Tachileik 365.7527 722.7723  58.662703 678.33727   79.606084
Hopang    127.6748 555.2782  94.418688 452.74608   22.467903
Mongmao   120.0574 512.6855  85.495452 424.98803   11.297271
Mongyai   168.4424 364.2707  20.333133 135.12905    9.378752
Tangyan   223.8632 453.2753  22.594047 105.23021   12.065335
Matman    244.1230 219.4093   8.438819  45.20796    6.027728</code></pre>
</div>
</div>
</section>
<section id="data-standardisation" class="level2">
<h2 class="anchored" data-anchor-id="data-standardisation">5.2 Data Standardisation</h2>
<section id="min-max-standardisation" class="level3">
<h3 class="anchored" data-anchor-id="min-max-standardisation">5.2.1 Min-Max standardisation</h3>
<p>All values to range between 0 - 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>shan_ict.std <span class="ot">&lt;-</span> <span class="fu">normalize</span>(shan_ict)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan_ict.std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.2472   1st Qu.:0.4420   1st Qu.:0.1141   1st Qu.:0.1974  
 Median :0.3935   Median :0.6064   Median :0.1820   Median :0.3700  
 Mean   :0.4142   Mean   :0.5734   Mean   :0.2509   Mean   :0.4068  
 3rd Qu.:0.5184   3rd Qu.:0.7151   3rd Qu.:0.3653   3rd Qu.:0.5939  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
  COMPUTER_PR    
 Min.   :0.0000  
 1st Qu.:0.1045  
 Median :0.1636  
 Mean   :0.2573  
 3rd Qu.:0.3378  
 Max.   :1.0000  </code></pre>
</div>
</div>
</section>
<section id="z-score-standardisation" class="level3">
<h3 class="anchored" data-anchor-id="z-score-standardisation">5.2.2 Z-score standardisation</h3>
<p>(Assumes normal distribution)</p>
<p>Mean and stdev are 0 and 1 respectively</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>shan_ict.z <span class="ot">&lt;-</span> <span class="fu">scale</span>(shan_ict)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(shan_ict.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis
RADIO_PR       1 55    0  1  -0.09   -0.07 0.95 -1.84 2.60  4.44  0.59    -0.19
TV_PR          2 55    0  1   0.15    0.05 0.84 -2.52 1.88  4.40 -0.48    -0.29
LLPHONE_PR     3 55    0  1  -0.34   -0.12 0.64 -1.25 3.74  5.00  1.38     2.14
MPHONE_PR      4 55    0  1  -0.14   -0.05 1.16 -1.53 2.23  3.76  0.41    -0.74
COMPUTER_PR    5 55    0  1  -0.39   -0.17 0.60 -1.08 3.11  4.19  1.48     1.45
              se
RADIO_PR    0.13
TV_PR       0.13
LLPHONE_PR  0.13
MPHONE_PR   0.13
COMPUTER_PR 0.13</code></pre>
</div>
</div>
</section>
<section id="visualising-the-standardised-clustering-variables" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-standardised-clustering-variables">5.2.3 Visualising the standardised clustering variables</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="computing-proximity-matrix" class="level2">
<h2 class="anchored" data-anchor-id="computing-proximity-matrix">5.3 Computing proximity matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(shan_ict, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#proxmat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="computing-hierarchical-clustering">5.4 Computing hierarchical clustering</h2>
<section id="perform-hierarchical-cluster-analysis" class="level3">
<h3 class="anchored" data-anchor-id="perform-hierarchical-cluster-analysis">5.4.1 Perform hierarchical cluster analysis</h3>
<p>Use ward.D method</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> <span class="st">'ward.D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="select-optimal-clustering-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="select-optimal-clustering-algorithm">5.4.2 Select Optimal clustering algorithm</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(shan_ict, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.8365556 0.7006561 0.8983065 0.9488899 </code></pre>
</div>
</div>
<p>Ward’s method provides the strongest clustering structure among the four methods assessed hence Ward’s method will be used.</p>
</section>
<section id="determining-optimal-clusters" class="level3">
<h3 class="anchored" data-anchor-id="determining-optimal-clusters">5.4.3 Determining Optimal Clusters</h3>
<section id="gap-statistic-method" class="level4">
<h4 class="anchored" data-anchor-id="gap-statistic-method">5.4.3.1 Gap Statistic Method</h4>
<p>The <a href="http://www.web.stanford.edu/~hastie/Papers/gap.pdf"><strong>gap statistic</strong></a> compares the total within intra-cluster variation for different values of k with their expected values under null reference distribution of the data. The estimate of the optimal clusters will be value that maximize the gap statistic (i.e., that yields the largest gap statistic). This means that the clustering structure is far away from the random uniform distribution of points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(shan_ict, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> hcut, </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nstart =</span> <span class="dv">25</span>, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>, </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gap_stat, <span class="at">method =</span> <span class="st">"firstmax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 1
          logW   E.logW       gap     SE.sim
 [1,] 8.401924 8.672479 0.2705551 0.04333897
 [2,] 8.107732 8.367009 0.2592767 0.03924690
 [3,] 7.965003 8.219640 0.2546364 0.03367975
 [4,] 7.829605 8.093406 0.2638009 0.03782676
 [5,] 7.695818 7.992070 0.2962516 0.03681358
 [6,] 7.616339 7.898464 0.2821247 0.03975286
 [7,] 7.551722 7.816837 0.2651150 0.04068218
 [8,] 7.489050 7.742131 0.2530806 0.04244978
 [9,] 7.403910 7.672548 0.2686377 0.04533739
[10,] 7.323138 7.607562 0.2844236 0.04679361</code></pre>
</div>
</div>
<p><strong>Plot</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With reference to the gap statistic graph above, the recommended number of cluster to retain is 1. However, it is not logical to retain only one cluster. By examine the gap statistic graph, the 6-cluster gives the largest gap statistic and should be the next best cluster to pick.</p>
</section>
</section>
<section id="interpreting-the-dendrograms" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-dendrograms">5.4.4 Interpreting the dendrograms</h3>
<p>In the dendrogram displayed above, each leaf corresponds to one observation. As we move up the tree, observations that are similar to each other are combined into branches, which are themselves fused at a higher height.</p>
<p>The height of the fusion, provided on the vertical axis, indicates the (dis)similarity between two observations. The higher the height of the fusion, the less similar the observations are. Note that, conclusions about the proximity of two observations can be drawn only based on the height where branches containing those two observations first are fused. We cannot use the proximity of two observations along the horizontal axis as a criteria of their similarity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="visually-driven-hierarchical-clustering-analysis" class="level3">
<h3 class="anchored" data-anchor-id="visually-driven-hierarchical-clustering-analysis">5.4.5 Visually-driven hierarchical clustering analysis</h3>
<p>Transforming the data frame into a matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>shan_ict_mat <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot interactive map</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(shan_ict_mat),</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> <span class="st">"ward.D"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> Blues,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> <span class="dv">6</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">200</span>,<span class="dv">60</span>,<span class="cn">NA</span>),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of Shan State by ICT indicators"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"ICT Indicators"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Townships of Shan State"</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f547fdd7f7cb17180a7c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f547fdd7f7cb17180a7c">{"x":{"data":[{"x":[1,2,3,4,5],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"z":[[0.925339788593026,0.8786419166706,0.391551407290058,0.528981801478617,0.172577449537917],[0.830580457112936,0.574226818795665,0.222253044854804,0.512978272135287,0.286447738198204],[0.7855082884464,0.726682694920949,0.132266485312925,0.371369583885633,0.192523331464284],[0.711885913687966,0.640383655283818,0.199599204123416,0.425634605779262,0.163592963312606],[0.657268142927172,0.650082316899278,0.0907572048090615,0.467482802755799,0.162637274367715],[0.577296011987397,0.649554836871842,0.18200927177224,0.333073906318751,0.116359341873804],[0.646405281657344,0.62244912150288,0.207338745441228,0.264986293096815,0.205591563121685],[0.857085250890269,0.576902626260915,0.0954404378234391,0.187083309549793,0.125825128566461],[1,0.214308650760161,0.0512340297746273,0.124550987294219,0.014893024965656],[0.478893210421571,0.762955490616495,0.181528926899385,0.101938828576106,0.218158802838492],[0.416401321895133,0.515499429849691,0.384940109628008,0.258490670666973,0.15798574132527],[0.405456153912216,0.503821747920775,0.165251926083381,0.25773415029997,0.146729834823645],[0.389610778119235,0.533507254842702,0.165281214256075,0.345537394787613,0.148186755190316],[0.373984378444241,0.606448552988281,0.114621191343714,0.292885463403979,0.118942174608967],[0.478450213123567,0.501784142188678,0.0408701497863918,0.271820085904793,0.1271486707607],[0.493298996307735,0.577553497420326,0.1623692849231,0.161399916816875,0.0869850623671916],[0.444472347933762,0.500019838815655,0.110874787457869,0.102192049346479,0.11512708893065],[0.458020791499385,0.424376634000908,0.119089094559121,0.0501902055308958,0.103990960989911],[0.45933460855278,0.406946330238945,0.113655496814988,0.0911147026366588,0.0748091950665973],[0.48765098274872,0.15327637322168,0.0316650514783228,0.0130522376146599,0.0360264674983717],[0.381519415596074,0.107208100082454,0.0295999006447705,0.0272920138244661,0.00480186012571408],[0.301432109584335,0,0.0180206673088627,0.0212965277288934,0.0669549131965064],[0.175038026833352,0.175652199540381,0,0,0.0590394209543779],[0.136536238327909,0.292626063696084,0.146912934029539,0.116169240922403,0.0468462575603844],[0.326356823524146,0.368056429509169,0.0982231808523387,0.146595201734622,0.0799293019321098],[0.305825558255868,0.300446996692705,0.100995899232685,0.191477873087001,0.10384049879333],[0.24549379752068,0.331462605415609,0.158292193815177,0.203415103457497,0.138073432022251],[0.221517109806136,0.459557714057194,0.158369247723877,0.203909992435622,0.215503159685549],[0.127783573954481,0.139457018034214,0.22051676674467,0.399272071479175,0],[0.129851148743542,0.371718495297501,0.146680718622619,0.715420522321358,0.0358376467167695],[0,0.360742635017452,0.567471007906168,0.665190381769088,0.061432064808114],[0.227207575735967,0.702410638302911,1,0.298756220041456,0.229369078708456],[0.239470870748104,0.651255314794556,0.512790647715119,0.618292293712165,0.251414453598094],[0.223236495653537,0.588104908348869,0.462858065656792,0.57706846811955,0.105064443791557],[0.121243805865775,0.645477370749871,0.418460341255506,0.719313875182682,0.125176727833969],[0.267419651378234,0.831322692266631,0.495666220485763,0.772933540986277,0.137621268173441],[0.255053443771093,0.796953332317982,0.49811595358599,0.831766399711343,0.352229781665242],[0.515782161138925,0.76030900989063,0.235277615529988,0.587289377963571,0.215099775291748],[0.565738814624888,0.734791645027591,0.219828980006303,0.553020201250384,0.345268342365355],[0.520935321104337,0.678617106708312,0.373007379661945,0.474910857680479,0.360468339160108],[0.294204185941567,0.703562443492951,0.351129977629807,0.334171469013736,0.320732404644485],[0.324454113828682,0.522368642120655,0.216072941883642,0.369964552977663,0.282911926353762],[0.41415988313871,0.623632896548039,0.166698465072824,0.382021558117873,0.269040379601737],[0.39348550752124,0.688824716877243,0.1844047891447,0.438180213346048,0.375020477146889],[0.354178958777764,0.670033566408488,0.0213747429238766,0.264639348241462,0.386302984960608],[0.248936918068475,0.671175841311046,0.114557418701979,0.348670619123792,0.330244689397937],[0.174311749054726,0.546908564204572,0.328548595483883,0.591865626167203,0.613832846556056],[0.454866237467771,0.594869160423842,0.105215687600081,0.59600971701147,0.56608174422786],[0.537493260083357,0.773588373613607,0.338119112137043,0.669653158140335,0.579921263544221],[0.469782510702851,0.837345233317381,0.357599483272661,0.634766673393121,0.745975355661402],[0.693011855430187,0.895033342006948,0.396213445606314,0.740528245291002,0.895576458497461],[0.746874117742617,0.89959190796526,0.31270753838903,0.953320650274524,1],[0.287396351046489,1,0.6772979982016,0.993398822979393,0.852126789514484],[0.142512925935779,0.826085850676895,0.471174055309928,0.770310587321205,0.777145541444691],[0.0785524817663635,0.971043348185156,0.731974244177918,1,0.450695662809217]],"text":[["row: Mabein<br>column: RADIO_PR<br>value: 0.925340","row: Mabein<br>column: TV_PR<br>value: 0.878642","row: Mabein<br>column: LLPHONE_PR<br>value: 0.391551","row: Mabein<br>column: MPHONE_PR<br>value: 0.528982","row: Mabein<br>column: COMPUTER_PR<br>value: 0.172577"],["row: Monghpyak<br>column: RADIO_PR<br>value: 0.830580","row: Monghpyak<br>column: TV_PR<br>value: 0.574227","row: Monghpyak<br>column: LLPHONE_PR<br>value: 0.222253","row: Monghpyak<br>column: MPHONE_PR<br>value: 0.512978","row: Monghpyak<br>column: COMPUTER_PR<br>value: 0.286448"],["row: Lawksawk<br>column: RADIO_PR<br>value: 0.785508","row: Lawksawk<br>column: TV_PR<br>value: 0.726683","row: Lawksawk<br>column: LLPHONE_PR<br>value: 0.132266","row: Lawksawk<br>column: MPHONE_PR<br>value: 0.371370","row: Lawksawk<br>column: COMPUTER_PR<br>value: 0.192523"],["row: Nawnghkio<br>column: RADIO_PR<br>value: 0.711886","row: Nawnghkio<br>column: TV_PR<br>value: 0.640384","row: Nawnghkio<br>column: LLPHONE_PR<br>value: 0.199599","row: Nawnghkio<br>column: MPHONE_PR<br>value: 0.425635","row: Nawnghkio<br>column: COMPUTER_PR<br>value: 0.163593"],["row: Nyaungshwe<br>column: RADIO_PR<br>value: 0.657268","row: Nyaungshwe<br>column: TV_PR<br>value: 0.650082","row: Nyaungshwe<br>column: LLPHONE_PR<br>value: 0.090757","row: Nyaungshwe<br>column: MPHONE_PR<br>value: 0.467483","row: Nyaungshwe<br>column: COMPUTER_PR<br>value: 0.162637"],["row: Mongmit<br>column: RADIO_PR<br>value: 0.577296","row: Mongmit<br>column: TV_PR<br>value: 0.649555","row: Mongmit<br>column: LLPHONE_PR<br>value: 0.182009","row: Mongmit<br>column: MPHONE_PR<br>value: 0.333074","row: Mongmit<br>column: COMPUTER_PR<br>value: 0.116359"],["row: Pekon<br>column: RADIO_PR<br>value: 0.646405","row: Pekon<br>column: TV_PR<br>value: 0.622449","row: Pekon<br>column: LLPHONE_PR<br>value: 0.207339","row: Pekon<br>column: MPHONE_PR<br>value: 0.264986","row: Pekon<br>column: COMPUTER_PR<br>value: 0.205592"],["row: Pindaya<br>column: RADIO_PR<br>value: 0.857085","row: Pindaya<br>column: TV_PR<br>value: 0.576903","row: Pindaya<br>column: LLPHONE_PR<br>value: 0.095440","row: Pindaya<br>column: MPHONE_PR<br>value: 0.187083","row: Pindaya<br>column: COMPUTER_PR<br>value: 0.125825"],["row: Ywangan<br>column: RADIO_PR<br>value: 1.000000","row: Ywangan<br>column: TV_PR<br>value: 0.214309","row: Ywangan<br>column: LLPHONE_PR<br>value: 0.051234","row: Ywangan<br>column: MPHONE_PR<br>value: 0.124551","row: Ywangan<br>column: COMPUTER_PR<br>value: 0.014893"],["row: Namtu<br>column: RADIO_PR<br>value: 0.478893","row: Namtu<br>column: TV_PR<br>value: 0.762955","row: Namtu<br>column: LLPHONE_PR<br>value: 0.181529","row: Namtu<br>column: MPHONE_PR<br>value: 0.101939","row: Namtu<br>column: COMPUTER_PR<br>value: 0.218159"],["row: Kutkai<br>column: RADIO_PR<br>value: 0.416401","row: Kutkai<br>column: TV_PR<br>value: 0.515499","row: Kutkai<br>column: LLPHONE_PR<br>value: 0.384940","row: Kutkai<br>column: MPHONE_PR<br>value: 0.258491","row: Kutkai<br>column: COMPUTER_PR<br>value: 0.157986"],["row: Hopong<br>column: RADIO_PR<br>value: 0.405456","row: Hopong<br>column: TV_PR<br>value: 0.503822","row: Hopong<br>column: LLPHONE_PR<br>value: 0.165252","row: Hopong<br>column: MPHONE_PR<br>value: 0.257734","row: Hopong<br>column: COMPUTER_PR<br>value: 0.146730"],["row: Hsipaw<br>column: RADIO_PR<br>value: 0.389611","row: Hsipaw<br>column: TV_PR<br>value: 0.533507","row: Hsipaw<br>column: LLPHONE_PR<br>value: 0.165281","row: Hsipaw<br>column: MPHONE_PR<br>value: 0.345537","row: Hsipaw<br>column: COMPUTER_PR<br>value: 0.148187"],["row: Pinlaung<br>column: RADIO_PR<br>value: 0.373984","row: Pinlaung<br>column: TV_PR<br>value: 0.606449","row: Pinlaung<br>column: LLPHONE_PR<br>value: 0.114621","row: Pinlaung<br>column: MPHONE_PR<br>value: 0.292885","row: Pinlaung<br>column: COMPUTER_PR<br>value: 0.118942"],["row: Monghsu<br>column: RADIO_PR<br>value: 0.478450","row: Monghsu<br>column: TV_PR<br>value: 0.501784","row: Monghsu<br>column: LLPHONE_PR<br>value: 0.040870","row: Monghsu<br>column: MPHONE_PR<br>value: 0.271820","row: Monghsu<br>column: COMPUTER_PR<br>value: 0.127149"],["row: Hsihseng<br>column: RADIO_PR<br>value: 0.493299","row: Hsihseng<br>column: TV_PR<br>value: 0.577553","row: Hsihseng<br>column: LLPHONE_PR<br>value: 0.162369","row: Hsihseng<br>column: MPHONE_PR<br>value: 0.161400","row: Hsihseng<br>column: COMPUTER_PR<br>value: 0.086985"],["row: Tangyan<br>column: RADIO_PR<br>value: 0.444472","row: Tangyan<br>column: TV_PR<br>value: 0.500020","row: Tangyan<br>column: LLPHONE_PR<br>value: 0.110875","row: Tangyan<br>column: MPHONE_PR<br>value: 0.102192","row: Tangyan<br>column: COMPUTER_PR<br>value: 0.115127"],["row: Kyethi<br>column: RADIO_PR<br>value: 0.458021","row: Kyethi<br>column: TV_PR<br>value: 0.424377","row: Kyethi<br>column: LLPHONE_PR<br>value: 0.119089","row: Kyethi<br>column: MPHONE_PR<br>value: 0.050190","row: Kyethi<br>column: COMPUTER_PR<br>value: 0.103991"],["row: Namhsan<br>column: RADIO_PR<br>value: 0.459335","row: Namhsan<br>column: TV_PR<br>value: 0.406946","row: Namhsan<br>column: LLPHONE_PR<br>value: 0.113655","row: Namhsan<br>column: MPHONE_PR<br>value: 0.091115","row: Namhsan<br>column: COMPUTER_PR<br>value: 0.074809"],["row: Matman<br>column: RADIO_PR<br>value: 0.487651","row: Matman<br>column: TV_PR<br>value: 0.153276","row: Matman<br>column: LLPHONE_PR<br>value: 0.031665","row: Matman<br>column: MPHONE_PR<br>value: 0.013052","row: Matman<br>column: COMPUTER_PR<br>value: 0.036026"],["row: Manton<br>column: RADIO_PR<br>value: 0.381519","row: Manton<br>column: TV_PR<br>value: 0.107208","row: Manton<br>column: LLPHONE_PR<br>value: 0.029600","row: Manton<br>column: MPHONE_PR<br>value: 0.027292","row: Manton<br>column: COMPUTER_PR<br>value: 0.004802"],["row: Mongkaing<br>column: RADIO_PR<br>value: 0.301432","row: Mongkaing<br>column: TV_PR<br>value: 0.000000","row: Mongkaing<br>column: LLPHONE_PR<br>value: 0.018021","row: Mongkaing<br>column: MPHONE_PR<br>value: 0.021297","row: Mongkaing<br>column: COMPUTER_PR<br>value: 0.066955"],["row: Mawkmai<br>column: RADIO_PR<br>value: 0.175038","row: Mawkmai<br>column: TV_PR<br>value: 0.175652","row: Mawkmai<br>column: LLPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: MPHONE_PR<br>value: 0.000000","row: Mawkmai<br>column: COMPUTER_PR<br>value: 0.059039"],["row: Mongkhet<br>column: RADIO_PR<br>value: 0.136536","row: Mongkhet<br>column: TV_PR<br>value: 0.292626","row: Mongkhet<br>column: LLPHONE_PR<br>value: 0.146913","row: Mongkhet<br>column: MPHONE_PR<br>value: 0.116169","row: Mongkhet<br>column: COMPUTER_PR<br>value: 0.046846"],["row: Mongyai<br>column: RADIO_PR<br>value: 0.326357","row: Mongyai<br>column: TV_PR<br>value: 0.368056","row: Mongyai<br>column: LLPHONE_PR<br>value: 0.098223","row: Mongyai<br>column: MPHONE_PR<br>value: 0.146595","row: Mongyai<br>column: COMPUTER_PR<br>value: 0.079929"],["row: Mongping<br>column: RADIO_PR<br>value: 0.305826","row: Mongping<br>column: TV_PR<br>value: 0.300447","row: Mongping<br>column: LLPHONE_PR<br>value: 0.100996","row: Mongping<br>column: MPHONE_PR<br>value: 0.191478","row: Mongping<br>column: COMPUTER_PR<br>value: 0.103840"],["row: Mongton<br>column: RADIO_PR<br>value: 0.245494","row: Mongton<br>column: TV_PR<br>value: 0.331463","row: Mongton<br>column: LLPHONE_PR<br>value: 0.158292","row: Mongton<br>column: MPHONE_PR<br>value: 0.203415","row: Mongton<br>column: COMPUTER_PR<br>value: 0.138073"],["row: Monghsat<br>column: RADIO_PR<br>value: 0.221517","row: Monghsat<br>column: TV_PR<br>value: 0.459558","row: Monghsat<br>column: LLPHONE_PR<br>value: 0.158369","row: Monghsat<br>column: MPHONE_PR<br>value: 0.203910","row: Monghsat<br>column: COMPUTER_PR<br>value: 0.215503"],["row: Narphan<br>column: RADIO_PR<br>value: 0.127784","row: Narphan<br>column: TV_PR<br>value: 0.139457","row: Narphan<br>column: LLPHONE_PR<br>value: 0.220517","row: Narphan<br>column: MPHONE_PR<br>value: 0.399272","row: Narphan<br>column: COMPUTER_PR<br>value: 0.000000"],["row: Pangwaun<br>column: RADIO_PR<br>value: 0.129851","row: Pangwaun<br>column: TV_PR<br>value: 0.371718","row: Pangwaun<br>column: LLPHONE_PR<br>value: 0.146681","row: Pangwaun<br>column: MPHONE_PR<br>value: 0.715421","row: Pangwaun<br>column: COMPUTER_PR<br>value: 0.035838"],["row: Konkyan<br>column: RADIO_PR<br>value: 0.000000","row: Konkyan<br>column: TV_PR<br>value: 0.360743","row: Konkyan<br>column: LLPHONE_PR<br>value: 0.567471","row: Konkyan<br>column: MPHONE_PR<br>value: 0.665190","row: Konkyan<br>column: COMPUTER_PR<br>value: 0.061432"],["row: Kunlong<br>column: RADIO_PR<br>value: 0.227208","row: Kunlong<br>column: TV_PR<br>value: 0.702411","row: Kunlong<br>column: LLPHONE_PR<br>value: 1.000000","row: Kunlong<br>column: MPHONE_PR<br>value: 0.298756","row: Kunlong<br>column: COMPUTER_PR<br>value: 0.229369"],["row: Hopang<br>column: RADIO_PR<br>value: 0.239471","row: Hopang<br>column: TV_PR<br>value: 0.651255","row: Hopang<br>column: LLPHONE_PR<br>value: 0.512791","row: Hopang<br>column: MPHONE_PR<br>value: 0.618292","row: Hopang<br>column: COMPUTER_PR<br>value: 0.251414"],["row: Mongmao<br>column: RADIO_PR<br>value: 0.223236","row: Mongmao<br>column: TV_PR<br>value: 0.588105","row: Mongmao<br>column: LLPHONE_PR<br>value: 0.462858","row: Mongmao<br>column: MPHONE_PR<br>value: 0.577068","row: Mongmao<br>column: COMPUTER_PR<br>value: 0.105064"],["row: Mongyang<br>column: RADIO_PR<br>value: 0.121244","row: Mongyang<br>column: TV_PR<br>value: 0.645477","row: Mongyang<br>column: LLPHONE_PR<br>value: 0.418460","row: Mongyang<br>column: MPHONE_PR<br>value: 0.719314","row: Mongyang<br>column: COMPUTER_PR<br>value: 0.125177"],["row: Mongyawng<br>column: RADIO_PR<br>value: 0.267420","row: Mongyawng<br>column: TV_PR<br>value: 0.831323","row: Mongyawng<br>column: LLPHONE_PR<br>value: 0.495666","row: Mongyawng<br>column: MPHONE_PR<br>value: 0.772934","row: Mongyawng<br>column: COMPUTER_PR<br>value: 0.137621"],["row: Namhkan<br>column: RADIO_PR<br>value: 0.255053","row: Namhkan<br>column: TV_PR<br>value: 0.796953","row: Namhkan<br>column: LLPHONE_PR<br>value: 0.498116","row: Namhkan<br>column: MPHONE_PR<br>value: 0.831766","row: Namhkan<br>column: COMPUTER_PR<br>value: 0.352230"],["row: Hseni<br>column: RADIO_PR<br>value: 0.515782","row: Hseni<br>column: TV_PR<br>value: 0.760309","row: Hseni<br>column: LLPHONE_PR<br>value: 0.235278","row: Hseni<br>column: MPHONE_PR<br>value: 0.587289","row: Hseni<br>column: COMPUTER_PR<br>value: 0.215100"],["row: Kalaw<br>column: RADIO_PR<br>value: 0.565739","row: Kalaw<br>column: TV_PR<br>value: 0.734792","row: Kalaw<br>column: LLPHONE_PR<br>value: 0.219829","row: Kalaw<br>column: MPHONE_PR<br>value: 0.553020","row: Kalaw<br>column: COMPUTER_PR<br>value: 0.345268"],["row: Langkho<br>column: RADIO_PR<br>value: 0.520935","row: Langkho<br>column: TV_PR<br>value: 0.678617","row: Langkho<br>column: LLPHONE_PR<br>value: 0.373007","row: Langkho<br>column: MPHONE_PR<br>value: 0.474911","row: Langkho<br>column: COMPUTER_PR<br>value: 0.360468"],["row: Laihka<br>column: RADIO_PR<br>value: 0.294204","row: Laihka<br>column: TV_PR<br>value: 0.703562","row: Laihka<br>column: LLPHONE_PR<br>value: 0.351130","row: Laihka<br>column: MPHONE_PR<br>value: 0.334171","row: Laihka<br>column: COMPUTER_PR<br>value: 0.320732"],["row: Kunhing<br>column: RADIO_PR<br>value: 0.324454","row: Kunhing<br>column: TV_PR<br>value: 0.522369","row: Kunhing<br>column: LLPHONE_PR<br>value: 0.216073","row: Kunhing<br>column: MPHONE_PR<br>value: 0.369965","row: Kunhing<br>column: COMPUTER_PR<br>value: 0.282912"],["row: Kyaukme<br>column: RADIO_PR<br>value: 0.414160","row: Kyaukme<br>column: TV_PR<br>value: 0.623633","row: Kyaukme<br>column: LLPHONE_PR<br>value: 0.166698","row: Kyaukme<br>column: MPHONE_PR<br>value: 0.382022","row: Kyaukme<br>column: COMPUTER_PR<br>value: 0.269040"],["row: Nansang<br>column: RADIO_PR<br>value: 0.393486","row: Nansang<br>column: TV_PR<br>value: 0.688825","row: Nansang<br>column: LLPHONE_PR<br>value: 0.184405","row: Nansang<br>column: MPHONE_PR<br>value: 0.438180","row: Nansang<br>column: COMPUTER_PR<br>value: 0.375020"],["row: Mongnai<br>column: RADIO_PR<br>value: 0.354179","row: Mongnai<br>column: TV_PR<br>value: 0.670034","row: Mongnai<br>column: LLPHONE_PR<br>value: 0.021375","row: Mongnai<br>column: MPHONE_PR<br>value: 0.264639","row: Mongnai<br>column: COMPUTER_PR<br>value: 0.386303"],["row: Loilen<br>column: RADIO_PR<br>value: 0.248937","row: Loilen<br>column: TV_PR<br>value: 0.671176","row: Loilen<br>column: LLPHONE_PR<br>value: 0.114557","row: Loilen<br>column: MPHONE_PR<br>value: 0.348671","row: Loilen<br>column: COMPUTER_PR<br>value: 0.330245"],["row: Pangsang<br>column: RADIO_PR<br>value: 0.174312","row: Pangsang<br>column: TV_PR<br>value: 0.546909","row: Pangsang<br>column: LLPHONE_PR<br>value: 0.328549","row: Pangsang<br>column: MPHONE_PR<br>value: 0.591866","row: Pangsang<br>column: COMPUTER_PR<br>value: 0.613833"],["row: Mongpan<br>column: RADIO_PR<br>value: 0.454866","row: Mongpan<br>column: TV_PR<br>value: 0.594869","row: Mongpan<br>column: LLPHONE_PR<br>value: 0.105216","row: Mongpan<br>column: MPHONE_PR<br>value: 0.596010","row: Mongpan<br>column: COMPUTER_PR<br>value: 0.566082"],["row: Kengtung<br>column: RADIO_PR<br>value: 0.537493","row: Kengtung<br>column: TV_PR<br>value: 0.773588","row: Kengtung<br>column: LLPHONE_PR<br>value: 0.338119","row: Kengtung<br>column: MPHONE_PR<br>value: 0.669653","row: Kengtung<br>column: COMPUTER_PR<br>value: 0.579921"],["row: Lashio<br>column: RADIO_PR<br>value: 0.469783","row: Lashio<br>column: TV_PR<br>value: 0.837345","row: Lashio<br>column: LLPHONE_PR<br>value: 0.357599","row: Lashio<br>column: MPHONE_PR<br>value: 0.634767","row: Lashio<br>column: COMPUTER_PR<br>value: 0.745975"],["row: Taunggyi<br>column: RADIO_PR<br>value: 0.693012","row: Taunggyi<br>column: TV_PR<br>value: 0.895033","row: Taunggyi<br>column: LLPHONE_PR<br>value: 0.396213","row: Taunggyi<br>column: MPHONE_PR<br>value: 0.740528","row: Taunggyi<br>column: COMPUTER_PR<br>value: 0.895576"],["row: Tachileik<br>column: RADIO_PR<br>value: 0.746874","row: Tachileik<br>column: TV_PR<br>value: 0.899592","row: Tachileik<br>column: LLPHONE_PR<br>value: 0.312708","row: Tachileik<br>column: MPHONE_PR<br>value: 0.953321","row: Tachileik<br>column: COMPUTER_PR<br>value: 1.000000"],["row: Muse<br>column: RADIO_PR<br>value: 0.287396","row: Muse<br>column: TV_PR<br>value: 1.000000","row: Muse<br>column: LLPHONE_PR<br>value: 0.677298","row: Muse<br>column: MPHONE_PR<br>value: 0.993399","row: Muse<br>column: COMPUTER_PR<br>value: 0.852127"],["row: Mongla<br>column: RADIO_PR<br>value: 0.142513","row: Mongla<br>column: TV_PR<br>value: 0.826086","row: Mongla<br>column: LLPHONE_PR<br>value: 0.471174","row: Mongla<br>column: MPHONE_PR<br>value: 0.770311","row: Mongla<br>column: COMPUTER_PR<br>value: 0.777146"],["row: Laukkaing<br>column: RADIO_PR<br>value: 0.078552","row: Laukkaing<br>column: TV_PR<br>value: 0.971043","row: Laukkaing<br>column: LLPHONE_PR<br>value: 0.731974","row: Laukkaing<br>column: MPHONE_PR<br>value: 1.000000","row: Laukkaing<br>column: COMPUTER_PR<br>value: 0.450696"]],"colorscale":[[0,"#F7FBFF"],[0.00480186012571408,"#F6FAFE"],[0.0130522376146599,"#F4F9FE"],[0.014893024965656,"#F3F8FD"],[0.0180206673088627,"#F3F8FD"],[0.0212965277288934,"#F3F8FD"],[0.0213747429238766,"#F3F8FD"],[0.0272920138244661,"#F1F7FD"],[0.0295999006447705,"#F0F6FC"],[0.0316650514783228,"#F0F6FC"],[0.0358376467167695,"#EFF6FC"],[0.0360264674983717,"#EFF6FC"],[0.0408701497863918,"#EFF5FC"],[0.0468462575603844,"#EDF4FB"],[0.0501902055308958,"#ECF4FB"],[0.0512340297746273,"#ECF4FB"],[0.0590394209543779,"#EBF3FB"],[0.061432064808114,"#EAF2FA"],[0.0669549131965064,"#E9F2FA"],[0.0748091950665973,"#E8F1FA"],[0.0785524817663635,"#E7F0F9"],[0.0799293019321098,"#E7F0F9"],[0.0869850623671916,"#E5EFF9"],[0.0907572048090615,"#E4EFF9"],[0.0911147026366588,"#E4EFF9"],[0.0954404378234391,"#E4EEF8"],[0.0982231808523387,"#E3EEF8"],[0.100995899232685,"#E2EDF8"],[0.101938828576106,"#E2EDF8"],[0.102192049346479,"#E2EDF8"],[0.10384049879333,"#E2EDF8"],[0.103990960989911,"#E1EDF8"],[0.105064443791557,"#E1EDF8"],[0.105215687600081,"#E1EDF8"],[0.107208100082454,"#E1EDF8"],[0.110874787457869,"#E1ECF7"],[0.113655496814988,"#E0ECF7"],[0.114557418701979,"#E0ECF7"],[0.114621191343714,"#E0ECF7"],[0.11512708893065,"#E0ECF7"],[0.116169240922403,"#DFEBF7"],[0.116359341873804,"#DFEBF7"],[0.118942174608967,"#DFEBF7"],[0.119089094559121,"#DFEBF7"],[0.121243805865775,"#DEEBF7"],[0.124550987294219,"#DDEAF6"],[0.125176727833969,"#DDEAF6"],[0.125825128566461,"#DDEAF6"],[0.1271486707607,"#DDEAF6"],[0.127783573954481,"#DDEAF6"],[0.129851148743542,"#DDEAF6"],[0.132266485312925,"#DCE9F6"],[0.136536238327909,"#DBE9F6"],[0.137621268173441,"#DBE9F6"],[0.138073432022251,"#DBE9F6"],[0.139457018034214,"#DAE8F5"],[0.142512925935779,"#DAE8F5"],[0.146595201734622,"#DAE8F5"],[0.146680718622619,"#DAE8F5"],[0.146729834823645,"#DAE8F5"],[0.146912934029539,"#DAE8F5"],[0.148186755190316,"#D9E7F5"],[0.15327637322168,"#D8E7F5"],[0.15798574132527,"#D7E6F4"],[0.158292193815177,"#D7E6F4"],[0.158369247723877,"#D7E6F4"],[0.161399916816875,"#D7E6F4"],[0.1623692849231,"#D7E6F4"],[0.162637274367715,"#D7E6F4"],[0.163592963312606,"#D6E5F4"],[0.165251926083381,"#D6E5F4"],[0.165281214256075,"#D6E5F4"],[0.166698465072824,"#D5E5F4"],[0.172577449537917,"#D4E4F3"],[0.174311749054726,"#D4E4F3"],[0.175038026833352,"#D4E4F3"],[0.175652199540381,"#D4E4F3"],[0.181528926899385,"#D3E3F3"],[0.18200927177224,"#D3E3F3"],[0.1844047891447,"#D2E3F3"],[0.187083309549793,"#D1E2F2"],[0.191477873087001,"#D1E2F2"],[0.192523331464284,"#D1E2F2"],[0.199599204123416,"#CFE1F2"],[0.203415103457497,"#CEE0F1"],[0.203909992435622,"#CEE0F1"],[0.205591563121685,"#CEE0F1"],[0.207338745441228,"#CEE0F1"],[0.214308650760161,"#CCDFF1"],[0.215099775291748,"#CCDFF1"],[0.215503159685549,"#CCDFF1"],[0.216072941883642,"#CCDFF1"],[0.218158802838492,"#CBDEF0"],[0.219828980006303,"#CBDEF0"],[0.22051676674467,"#CBDEF0"],[0.221517109806136,"#CBDEF0"],[0.222253044854804,"#CBDEF0"],[0.223236495653537,"#CBDEF0"],[0.227207575735967,"#CADDF0"],[0.229369078708456,"#CADDF0"],[0.235277615529988,"#C8DCEF"],[0.239470870748104,"#C8DCEF"],[0.24549379752068,"#C6DBEF"],[0.248936918068475,"#C6DBEF"],[0.251414453598094,"#C5DAEE"],[0.255053443771093,"#C4DAEE"],[0.25773415029997,"#C3D9EE"],[0.258490670666973,"#C3D9EE"],[0.264639348241462,"#C1D9ED"],[0.264986293096815,"#C0D8ED"],[0.267419651378234,"#C0D8ED"],[0.269040379601737,"#BFD8EC"],[0.271820085904793,"#BFD8EC"],[0.282911926353762,"#BBD6EB"],[0.286447738198204,"#BAD6EA"],[0.287396351046489,"#BAD6EA"],[0.292626063696084,"#B8D4EA"],[0.292885463403979,"#B8D4EA"],[0.294204185941567,"#B7D4EA"],[0.298756220041456,"#B6D4E9"],[0.300446996692705,"#B5D3E9"],[0.301432109584335,"#B5D3E9"],[0.305825558255868,"#B4D3E8"],[0.31270753838903,"#B1D2E7"],[0.320732404644485,"#AFD1E6"],[0.324454113828682,"#AED0E6"],[0.326356823524146,"#ADD0E6"],[0.328548595483883,"#ACD0E6"],[0.330244689397937,"#ACD0E6"],[0.331462605415609,"#ABCFE5"],[0.333073906318751,"#ABCFE5"],[0.334171469013736,"#ABCFE5"],[0.338119112137043,"#AACFE5"],[0.345268342365355,"#A7CEE4"],[0.345537394787613,"#A7CEE4"],[0.348670619123792,"#A6CDE3"],[0.351129977629807,"#A5CDE3"],[0.352229781665242,"#A5CDE3"],[0.354178958777764,"#A4CDE3"],[0.357599483272661,"#A3CCE3"],[0.360468339160108,"#A2CBE2"],[0.360742635017452,"#A2CBE2"],[0.368056429509169,"#A0CAE1"],[0.369964552977663,"#9FCAE1"],[0.371369583885633,"#9FCAE1"],[0.371718495297501,"#9ECAE1"],[0.373007379661945,"#9ECAE1"],[0.373984378444241,"#9ECAE1"],[0.375020477146889,"#9DC9E0"],[0.381519415596074,"#9BC8E0"],[0.382021558117873,"#9BC8E0"],[0.384940109628008,"#9AC7E0"],[0.386302984960608,"#99C7DF"],[0.389610778119235,"#98C7DF"],[0.391551407290058,"#97C6DF"],[0.39348550752124,"#96C6DF"],[0.396213445606314,"#95C5DF"],[0.399272071479175,"#93C4DE"],[0.405456153912216,"#91C3DE"],[0.406946330238945,"#90C2DE"],[0.41415988313871,"#8EC0DD"],[0.416401321895133,"#8DC0DD"],[0.418460341255506,"#8CC0DD"],[0.424376634000908,"#8ABFDC"],[0.425634605779262,"#89BEDC"],[0.438180213346048,"#84BBDB"],[0.444472347933762,"#81BADB"],[0.450695662809217,"#7FB8DA"],[0.454866237467771,"#7DB8D9"],[0.458020791499385,"#7BB7D9"],[0.45933460855278,"#7BB7D9"],[0.459557714057194,"#7BB7D9"],[0.462858065656792,"#7AB6D9"],[0.467482802755799,"#78B5D8"],[0.469782510702851,"#77B4D8"],[0.471174055309928,"#77B4D8"],[0.474910857680479,"#75B3D8"],[0.478450213123567,"#73B2D7"],[0.478893210421571,"#73B2D7"],[0.48765098274872,"#70B1D7"],[0.493298996307735,"#6DAFD6"],[0.495666220485763,"#6CAFD6"],[0.49811595358599,"#6BAED6"],[0.500019838815655,"#6AADD5"],[0.501784142188678,"#6AADD5"],[0.503821747920775,"#6AADD5"],[0.512790647715119,"#66AAD4"],[0.512978272135287,"#66AAD4"],[0.515499429849691,"#66AAD4"],[0.515782161138925,"#65AAD3"],[0.520935321104337,"#63A9D3"],[0.522368642120655,"#63A9D3"],[0.528981801478617,"#61A7D2"],[0.533507254842702,"#60A6D1"],[0.537493260083357,"#5EA5D1"],[0.546908564204572,"#5BA3D0"],[0.553020201250384,"#59A2CF"],[0.565738814624888,"#559FCD"],[0.56608174422786,"#559FCD"],[0.567471007906168,"#549ECD"],[0.574226818795665,"#529DCC"],[0.576902626260915,"#519CCC"],[0.57706846811955,"#519CCC"],[0.577296011987397,"#519CCC"],[0.577553497420326,"#519CCC"],[0.579921263544221,"#509BCB"],[0.587289377963571,"#4E9ACA"],[0.588104908348869,"#4E9ACA"],[0.591865626167203,"#4C99CA"],[0.594869160423842,"#4B98C9"],[0.59600971701147,"#4B98C9"],[0.606448552988281,"#4795C8"],[0.613832846556056,"#4594C7"],[0.618292293712165,"#4493C6"],[0.62244912150288,"#4292C6"],[0.623632896548039,"#4292C6"],[0.634766673393121,"#3F8FC4"],[0.640383655283818,"#3E8EC4"],[0.645477370749871,"#3C8CC3"],[0.646405281657344,"#3C8CC3"],[0.649554836871842,"#3B8BC2"],[0.650082316899278,"#3B8BC2"],[0.651255314794556,"#3B8BC2"],[0.657268142927172,"#3989C1"],[0.665190381769088,"#3787C0"],[0.669653158140335,"#3585BF"],[0.670033566408488,"#3585BF"],[0.671175841311046,"#3585BF"],[0.6772979982016,"#3383BE"],[0.678617106708312,"#3383BE"],[0.688824716877243,"#3080BD"],[0.693011855430187,"#2F7FBC"],[0.702410638302911,"#2D7DBB"],[0.703562443492951,"#2D7DBB"],[0.711885913687966,"#2A7AB9"],[0.715420522321358,"#2A7AB9"],[0.719313875182682,"#2979B9"],[0.726682694920949,"#2777B8"],[0.731974244177918,"#2575B7"],[0.734791645027591,"#2575B7"],[0.740528245291002,"#2373B6"],[0.745975355661402,"#2272B5"],[0.746874117742617,"#2272B5"],[0.76030900989063,"#1E6EB2"],[0.762955490616495,"#1E6DB2"],[0.770310587321205,"#1D6CB1"],[0.772933540986277,"#1C6BB0"],[0.773588373613607,"#1C6BB0"],[0.777145541444691,"#1B6AAF"],[0.7855082884464,"#1A68AE"],[0.796953332317982,"#1765AB"],[0.826085850676895,"#115DA5"],[0.830580457112936,"#105CA4"],[0.831322692266631,"#105CA4"],[0.831766399711343,"#105CA4"],[0.837345233317381,"#0F5AA3"],[0.852126789514484,"#0C57A0"],[0.857085250890269,"#0B559F"],[0.8786419166706,"#08509A"],[0.895033342006948,"#084B94"],[0.895576458497461,"#084B93"],[0.89959190796526,"#084A92"],[0.925339788593026,"#084388"],[0.953320650274524,"#083C7D"],[0.971043348185156,"#083776"],[0.993398822979393,"#08326D"],[1,"#08306B"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_306696ee48c8158f9b168eae66068fb5","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F7FBFF"],[0.00334448160535117,"#F6FAFE"],[0.00668896321070234,"#F5F9FE"],[0.0100334448160535,"#F4F9FE"],[0.0133779264214047,"#F4F9FE"],[0.0167224080267559,"#F3F8FD"],[0.020066889632107,"#F3F8FD"],[0.0234113712374582,"#F2F7FD"],[0.0267558528428094,"#F1F7FD"],[0.0301003344481605,"#F0F6FC"],[0.0334448160535117,"#EFF6FC"],[0.0367892976588629,"#EFF6FC"],[0.040133779264214,"#EFF5FC"],[0.0434782608695652,"#EEF5FC"],[0.0468227424749164,"#EDF4FB"],[0.0501672240802676,"#ECF4FB"],[0.0535117056856187,"#ECF3FB"],[0.0568561872909699,"#ECF3FB"],[0.0602006688963211,"#EBF3FB"],[0.0635451505016722,"#EAF2FA"],[0.0668896321070234,"#E9F2FA"],[0.0702341137123746,"#E8F1FA"],[0.0735785953177257,"#E8F1FA"],[0.0769230769230769,"#E7F0F9"],[0.0802675585284281,"#E7F0F9"],[0.0836120401337793,"#E6F0F9"],[0.0869565217391304,"#E5EFF9"],[0.0903010033444816,"#E4EFF9"],[0.0936454849498328,"#E4EEF8"],[0.096989966555184,"#E3EEF8"],[0.100334448160535,"#E2EDF8"],[0.103678929765886,"#E2EDF8"],[0.107023411371237,"#E1EDF8"],[0.110367892976589,"#E1ECF7"],[0.11371237458194,"#E0ECF7"],[0.117056856187291,"#DFEBF7"],[0.120401337792642,"#DEEBF7"],[0.123745819397993,"#DDEAF6"],[0.127090301003344,"#DDEAF6"],[0.130434782608696,"#DDEAF6"],[0.133779264214047,"#DCE9F6"],[0.137123745819398,"#DBE9F6"],[0.140468227424749,"#DAE8F5"],[0.1438127090301,"#DAE8F5"],[0.147157190635451,"#D9E7F5"],[0.150501672240803,"#D9E7F5"],[0.153846153846154,"#D8E7F5"],[0.157190635451505,"#D7E6F4"],[0.160535117056856,"#D7E6F4"],[0.163879598662207,"#D6E5F4"],[0.167224080267559,"#D5E5F4"],[0.17056856187291,"#D5E5F4"],[0.173913043478261,"#D4E4F3"],[0.177257525083612,"#D4E4F3"],[0.180602006688963,"#D3E3F3"],[0.183946488294314,"#D2E3F3"],[0.187290969899666,"#D1E2F2"],[0.190635451505017,"#D1E2F2"],[0.193979933110368,"#D1E2F2"],[0.197324414715719,"#D0E1F2"],[0.20066889632107,"#CFE1F2"],[0.204013377926421,"#CEE0F1"],[0.207357859531773,"#CEE0F1"],[0.210702341137124,"#CDDFF1"],[0.214046822742475,"#CCDFF1"],[0.217391304347826,"#CCDFF1"],[0.220735785953177,"#CBDEF0"],[0.224080267558528,"#CBDEF0"],[0.22742474916388,"#CADDF0"],[0.230769230769231,"#C9DDF0"],[0.234113712374582,"#C8DCEF"],[0.237458193979933,"#C8DCEF"],[0.240802675585284,"#C8DCEF"],[0.244147157190635,"#C7DBEF"],[0.247491638795987,"#C6DBEF"],[0.250836120401338,"#C5DAEE"],[0.254180602006689,"#C4DAEE"],[0.25752508361204,"#C3D9EE"],[0.260869565217391,"#C2D9ED"],[0.264214046822742,"#C1D9ED"],[0.267558528428094,"#C0D8ED"],[0.270903010033445,"#BFD8EC"],[0.274247491638796,"#BED7EC"],[0.277591973244147,"#BCD7EB"],[0.280936454849498,"#BBD6EB"],[0.284280936454849,"#BBD6EB"],[0.287625418060201,"#BAD6EA"],[0.290969899665552,"#B9D5EA"],[0.294314381270903,"#B7D4EA"],[0.297658862876254,"#B6D4E9"],[0.301003344481605,"#B5D3E9"],[0.304347826086957,"#B4D3E8"],[0.307692307692308,"#B3D3E8"],[0.311036789297659,"#B2D2E8"],[0.31438127090301,"#B1D2E7"],[0.317725752508361,"#B0D1E7"],[0.321070234113712,"#AFD1E6"],[0.324414715719064,"#AED0E6"],[0.327759197324415,"#ACD0E6"],[0.331103678929766,"#ACD0E6"],[0.334448160535117,"#ABCFE5"],[0.337792642140468,"#AACFE5"],[0.341137123745819,"#A8CEE4"],[0.344481605351171,"#A7CEE4"],[0.347826086956522,"#A6CDE3"],[0.351170568561873,"#A5CDE3"],[0.354515050167224,"#A4CDE3"],[0.357859531772575,"#A3CCE3"],[0.361204013377926,"#A2CBE2"],[0.364548494983278,"#A1CBE2"],[0.367892976588629,"#A0CAE1"],[0.37123745819398,"#9FCAE1"],[0.374581939799331,"#9DC9E0"],[0.377926421404682,"#9CC9E0"],[0.381270903010033,"#9BC8E0"],[0.384615384615385,"#9AC7E0"],[0.387959866220736,"#98C7DF"],[0.391304347826087,"#97C6DF"],[0.394648829431438,"#96C5DF"],[0.397993311036789,"#94C5DF"],[0.40133779264214,"#93C4DE"],[0.404682274247492,"#92C3DE"],[0.408026755852843,"#90C2DE"],[0.411371237458194,"#8FC1DD"],[0.414715719063545,"#8DC0DD"],[0.418060200668896,"#8CC0DD"],[0.421404682274247,"#8BC0DD"],[0.424749163879599,"#89BFDC"],[0.42809364548495,"#88BEDC"],[0.431438127090301,"#87BDDC"],[0.434782608695652,"#85BCDB"],[0.438127090301003,"#84BBDB"],[0.441471571906354,"#82BADB"],[0.444816053511706,"#81BADB"],[0.448160535117057,"#80B9DA"],[0.451505016722408,"#7FB8DA"],[0.454849498327759,"#7DB8D9"],[0.45819397993311,"#7BB7D9"],[0.461538461538462,"#7AB6D9"],[0.464882943143813,"#79B5D8"],[0.468227424749164,"#78B5D8"],[0.471571906354515,"#77B4D8"],[0.474916387959866,"#75B3D8"],[0.478260869565217,"#73B2D7"],[0.481605351170569,"#72B1D7"],[0.48494983277592,"#71B1D7"],[0.488294314381271,"#6FB0D6"],[0.491638795986622,"#6EB0D6"],[0.494983277591973,"#6DAFD6"],[0.498327759197324,"#6BAED6"],[0.501672240802676,"#6AADD5"],[0.505016722408027,"#69ACD5"],[0.508361204013378,"#68ABD4"],[0.511705685618729,"#67ABD4"],[0.51505016722408,"#66AAD4"],[0.518394648829431,"#65AAD3"],[0.521739130434783,"#63A9D3"],[0.525083612040134,"#62A8D2"],[0.528428093645485,"#61A7D2"],[0.531772575250836,"#60A6D1"],[0.535117056856187,"#5FA6D1"],[0.538461538461538,"#5EA5D1"],[0.54180602006689,"#5DA4D0"],[0.545150501672241,"#5CA3D0"],[0.548494983277592,"#5AA3CF"],[0.551839464882943,"#59A2CF"],[0.555183946488294,"#58A1CE"],[0.558528428093645,"#58A1CE"],[0.561872909698997,"#56A0CE"],[0.565217391304348,"#559FCD"],[0.568561872909699,"#549ECD"],[0.57190635451505,"#539DCC"],[0.575250836120401,"#529CCC"],[0.578595317725752,"#509BCB"],[0.581939799331104,"#509BCB"],[0.585284280936455,"#4F9BCB"],[0.588628762541806,"#4E9ACA"],[0.591973244147157,"#4C99CA"],[0.595317725752508,"#4B98C9"],[0.598662207357859,"#4A97C9"],[0.602006688963211,"#4996C8"],[0.605351170568562,"#4896C8"],[0.608695652173913,"#4795C8"],[0.612040133779264,"#4694C7"],[0.615384615384615,"#4594C7"],[0.618729096989967,"#4393C6"],[0.622073578595318,"#4292C6"],[0.625418060200669,"#4292C6"],[0.62876254180602,"#4191C5"],[0.632107023411371,"#4090C5"],[0.635451505016722,"#3F8FC4"],[0.638795986622074,"#3E8EC4"],[0.642140468227425,"#3D8DC3"],[0.645484949832776,"#3C8CC3"],[0.648829431438127,"#3C8CC3"],[0.652173913043478,"#3B8BC2"],[0.655518394648829,"#3A8AC1"],[0.658862876254181,"#3989C1"],[0.662207357859532,"#3888C0"],[0.665551839464883,"#3787C0"],[0.668896321070234,"#3686BF"],[0.672240802675585,"#3585BF"],[0.675585284280936,"#3484BF"],[0.678929765886288,"#3383BE"],[0.682274247491639,"#3282BE"],[0.68561872909699,"#3181BD"],[0.688963210702341,"#3080BD"],[0.692307692307692,"#2F7FBC"],[0.695652173913043,"#2F7FBC"],[0.698996655518395,"#2E7EBC"],[0.702341137123746,"#2D7DBB"],[0.705685618729097,"#2C7CBB"],[0.709030100334448,"#2B7BBA"],[0.712374581939799,"#2A7AB9"],[0.71571906354515,"#2979B9"],[0.719063545150502,"#2979B9"],[0.722408026755853,"#2878B8"],[0.725752508361204,"#2777B8"],[0.729096989966555,"#2676B7"],[0.732441471571906,"#2575B7"],[0.735785953177257,"#2474B6"],[0.739130434782609,"#2474B6"],[0.74247491638796,"#2373B6"],[0.745819397993311,"#2272B5"],[0.749163879598662,"#2171B5"],[0.752508361204013,"#2070B4"],[0.755852842809364,"#1F6FB3"],[0.759197324414716,"#1E6EB2"],[0.762541806020067,"#1E6EB2"],[0.765886287625418,"#1E6DB2"],[0.769230769230769,"#1D6CB1"],[0.77257525083612,"#1C6BB0"],[0.775919732441472,"#1B6AAF"],[0.779264214046823,"#1A69AE"],[0.782608695652174,"#1A68AE"],[0.785953177257525,"#1A68AE"],[0.789297658862876,"#1967AD"],[0.792642140468227,"#1866AC"],[0.795986622073579,"#1765AB"],[0.79933110367893,"#1664AB"],[0.802675585284281,"#1663AA"],[0.806020066889632,"#1562A9"],[0.809364548494983,"#1562A9"],[0.812709030100334,"#1461A8"],[0.816053511705686,"#1360A7"],[0.819397993311037,"#135FA7"],[0.822742474916388,"#125EA6"],[0.826086956521739,"#115DA5"],[0.82943143812709,"#105CA4"],[0.832775919732441,"#105CA4"],[0.836120401337793,"#0F5BA3"],[0.839464882943144,"#0F5AA3"],[0.842809364548495,"#0E59A2"],[0.846153846153846,"#0D58A1"],[0.849498327759197,"#0C57A0"],[0.852842809364548,"#0C57A0"],[0.8561872909699,"#0C56A0"],[0.859531772575251,"#0B559F"],[0.862876254180602,"#0A549E"],[0.866220735785953,"#09539D"],[0.869565217391304,"#08529C"],[0.872909698996655,"#08519C"],[0.876254180602007,"#08519B"],[0.879598662207358,"#08509A"],[0.882943143812709,"#084F99"],[0.88628762541806,"#084E97"],[0.889632107023411,"#084C96"],[0.892976588628763,"#084B95"],[0.896321070234114,"#084A93"],[0.899665551839465,"#084A92"],[0.903010033444816,"#084990"],[0.906354515050167,"#08488F"],[0.909698996655518,"#08478E"],[0.91304347826087,"#08468C"],[0.916387959866221,"#08458B"],[0.919732441471572,"#08448A"],[0.923076923076923,"#084489"],[0.926421404682274,"#084388"],[0.929765886287625,"#084286"],[0.933110367892977,"#084185"],[0.936454849498328,"#084083"],[0.939799331103679,"#083F82"],[0.94314381270903,"#083E81"],[0.946488294314381,"#083E7F"],[0.949832775919732,"#083D7E"],[0.953177257525084,"#083C7D"],[0.956521739130435,"#083B7B"],[0.959866220735786,"#083A7A"],[0.963210702341137,"#083979"],[0.966555183946488,"#083978"],[0.969899665551839,"#083876"],[0.973244147157191,"#083775"],[0.976588628762542,"#083674"],[0.979933110367893,"#083572"],[0.983277591973244,"#083471"],[0.986622073578595,"#083370"],[0.989966555183946,"#08336F"],[0.993311036789298,"#08326D"],[0.996655518394649,"#08316C"],[1,"#08306B"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.03236023849479,1.03236023849479,null,1.03236023849479,0.748863080520009,null,0.748863080520009,0.748863080520009,null,0.748863080520009,0,null,0.748863080520009,0.748863080520009,null,0.748863080520009,0.414529663168362,null,0.414529663168362,0.414529663168362,null,0.414529663168362,0.221473595612978,null,0.221473595612978,0.221473595612978,null,0.221473595612978,0.172807756442938,null,0.172807756442938,0.172807756442938,null,0.172807756442938,0,null,0.172807756442938,0.172807756442938,null,0.172807756442938,0,null,0.221473595612978,0.221473595612978,null,0.221473595612978,0,null,0.414529663168362,0.414529663168362,null,0.414529663168362,0.225517840791032,null,0.225517840791032,0.225517840791032,null,0.225517840791032,0,null,0.225517840791032,0.225517840791032,null,0.225517840791032,0],"y":[39.3359375,33.6875,null,33.6875,33.6875,null,33.6875,32,null,32,32,null,33.6875,35.375,null,35.375,35.375,null,35.375,34.25,null,34.25,34.25,null,34.25,33.5,null,33.5,33.5,null,33.5,33,null,33,33,null,33.5,34,null,34,34,null,34.25,35,null,35,35,null,35.375,36.5,null,36.5,36.5,null,36.5,36,null,36,36,null,36.5,37,null,37,37],"text":["y: 1.03236024","y: 1.03236024",null,"y: 1.03236024","y: 1.03236024",null,"y: 0.74886308","y: 0.74886308",null,"y: 0.74886308","y: 0.74886308",null,"y: 0.74886308","y: 0.74886308",null,"y: 0.74886308","y: 0.74886308",null,"y: 0.41452966","y: 0.41452966",null,"y: 0.41452966","y: 0.41452966",null,"y: 0.22147360","y: 0.22147360",null,"y: 0.22147360","y: 0.22147360",null,"y: 0.17280776","y: 0.17280776",null,"y: 0.17280776","y: 0.17280776",null,"y: 0.17280776","y: 0.17280776",null,"y: 0.17280776","y: 0.17280776",null,"y: 0.22147360","y: 0.22147360",null,"y: 0.22147360","y: 0.22147360",null,"y: 0.41452966","y: 0.41452966",null,"y: 0.41452966","y: 0.41452966",null,"y: 0.22551784","y: 0.22551784",null,"y: 0.22551784","y: 0.22551784",null,"y: 0.22551784","y: 0.22551784",null,"y: 0.22551784","y: 0.22551784"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.03236023849479,1.03236023849479,null,1.03236023849479,0.651849875658604,null,0.651849875658604,0.651849875658604,null,0.651849875658604,0.461988387623568,null,0.461988387623568,0.461988387623568,null,0.461988387623568,0.243783841165056,null,0.243783841165056,0.243783841165056,null,0.243783841165056,0.146641385028952,null,0.146641385028952,0.146641385028952,null,0.146641385028952,0,null,0.146641385028952,0.146641385028952,null,0.146641385028952,0,null,0.243783841165056,0.243783841165056,null,0.243783841165056,0,null,0.461988387623568,0.461988387623568,null,0.461988387623568,0.350134103756468,null,0.350134103756468,0.350134103756468,null,0.350134103756468,0.244447910748327,null,0.244447910748327,0.244447910748327,null,0.244447910748327,0,null,0.244447910748327,0.244447910748327,null,0.244447910748327,0.215900883474592,null,0.215900883474592,0.215900883474592,null,0.215900883474592,0,null,0.215900883474592,0.215900883474592,null,0.215900883474592,0.139199471226951,null,0.139199471226951,0.139199471226951,null,0.139199471226951,0,null,0.139199471226951,0.139199471226951,null,0.139199471226951,0,null,0.350134103756468,0.350134103756468,null,0.350134103756468,0.173101097562283,null,0.173101097562283,0.173101097562283,null,0.173101097562283,0,null,0.173101097562283,0.173101097562283,null,0.173101097562283,0,null,0.651849875658604,0.651849875658604,null,0.651849875658604,0.437952653150223,null,0.437952653150223,0.437952653150223,null,0.437952653150223,0.364946528637733,null,0.364946528637733,0.364946528637733,null,0.364946528637733,0,null,0.364946528637733,0.364946528637733,null,0.364946528637733,0,null,0.437952653150223,0.437952653150223,null,0.437952653150223,0.19447415233757,null,0.19447415233757,0.19447415233757,null,0.19447415233757,0,null,0.19447415233757,0.19447415233757,null,0.19447415233757,0],"y":[39.3359375,44.984375,null,44.984375,44.984375,null,44.984375,41.46875,null,41.46875,41.46875,null,41.46875,39.25,null,39.25,39.25,null,39.25,38.5,null,38.5,38.5,null,38.5,38,null,38,38,null,38.5,39,null,39,39,null,39.25,40,null,40,40,null,41.46875,43.6875,null,43.6875,43.6875,null,43.6875,41.875,null,41.875,41.875,null,41.875,41,null,41,41,null,41.875,42.75,null,42.75,42.75,null,42.75,42,null,42,42,null,42.75,43.5,null,43.5,43.5,null,43.5,43,null,43,43,null,43.5,44,null,44,44,null,43.6875,45.5,null,45.5,45.5,null,45.5,45,null,45,45,null,45.5,46,null,46,46,null,44.984375,48.5,null,48.5,48.5,null,48.5,47.5,null,47.5,47.5,null,47.5,47,null,47,47,null,47.5,48,null,48,48,null,48.5,49.5,null,49.5,49.5,null,49.5,49,null,49,49,null,49.5,50,null,50,50],"text":["y: 1.03236024","y: 1.03236024",null,"y: 1.03236024","y: 1.03236024",null,"y: 0.65184988","y: 0.65184988",null,"y: 0.65184988","y: 0.65184988",null,"y: 0.46198839","y: 0.46198839",null,"y: 0.46198839","y: 0.46198839",null,"y: 0.24378384","y: 0.24378384",null,"y: 0.24378384","y: 0.24378384",null,"y: 0.14664139","y: 0.14664139",null,"y: 0.14664139","y: 0.14664139",null,"y: 0.14664139","y: 0.14664139",null,"y: 0.14664139","y: 0.14664139",null,"y: 0.24378384","y: 0.24378384",null,"y: 0.24378384","y: 0.24378384",null,"y: 0.46198839","y: 0.46198839",null,"y: 0.46198839","y: 0.46198839",null,"y: 0.35013410","y: 0.35013410",null,"y: 0.35013410","y: 0.35013410",null,"y: 0.24444791","y: 0.24444791",null,"y: 0.24444791","y: 0.24444791",null,"y: 0.24444791","y: 0.24444791",null,"y: 0.24444791","y: 0.24444791",null,"y: 0.21590088","y: 0.21590088",null,"y: 0.21590088","y: 0.21590088",null,"y: 0.21590088","y: 0.21590088",null,"y: 0.21590088","y: 0.21590088",null,"y: 0.13919947","y: 0.13919947",null,"y: 0.13919947","y: 0.13919947",null,"y: 0.13919947","y: 0.13919947",null,"y: 0.13919947","y: 0.13919947",null,"y: 0.35013410","y: 0.35013410",null,"y: 0.35013410","y: 0.35013410",null,"y: 0.17310110","y: 0.17310110",null,"y: 0.17310110","y: 0.17310110",null,"y: 0.17310110","y: 0.17310110",null,"y: 0.17310110","y: 0.17310110",null,"y: 0.65184988","y: 0.65184988",null,"y: 0.65184988","y: 0.65184988",null,"y: 0.43795265","y: 0.43795265",null,"y: 0.43795265","y: 0.43795265",null,"y: 0.36494653","y: 0.36494653",null,"y: 0.36494653","y: 0.36494653",null,"y: 0.36494653","y: 0.36494653",null,"y: 0.36494653","y: 0.36494653",null,"y: 0.43795265","y: 0.43795265",null,"y: 0.43795265","y: 0.43795265",null,"y: 0.19447415","y: 0.19447415",null,"y: 0.19447415","y: 0.19447415",null,"y: 0.19447415","y: 0.19447415",null,"y: 0.19447415","y: 0.19447415"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(125,176,221,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.996926956772014,0.996926956772014,null,0.996926956772014,0.510058484735049,null,0.510058484735049,0.510058484735049,null,0.510058484735049,0.400793725724871,null,0.400793725724871,0.400793725724871,null,0.400793725724871,0,null,0.400793725724871,0.400793725724871,null,0.400793725724871,0,null,0.510058484735049,0.510058484735049,null,0.510058484735049,0],"y":[27.140625,30.25,null,30.25,30.25,null,30.25,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.25,31,null,31,31],"text":["y: 0.99692696","y: 0.99692696",null,"y: 0.99692696","y: 0.99692696",null,"y: 0.51005848","y: 0.51005848",null,"y: 0.51005848","y: 0.51005848",null,"y: 0.40079373","y: 0.40079373",null,"y: 0.40079373","y: 0.40079373",null,"y: 0.40079373","y: 0.40079373",null,"y: 0.40079373","y: 0.40079373",null,"y: 0.51005848","y: 0.51005848",null,"y: 0.51005848","y: 0.51005848"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(134,184,117,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.996926956772014,0.996926956772014,null,0.996926956772014,0.541009873099094,null,0.541009873099094,0.541009873099094,null,0.541009873099094,0.316117336171604,null,0.316117336171604,0.316117336171604,null,0.316117336171604,0.120698829805239,null,0.120698829805239,0.120698829805239,null,0.120698829805239,0,null,0.120698829805239,0.120698829805239,null,0.120698829805239,0,null,0.316117336171604,0.316117336171604,null,0.316117336171604,0.218334836704626,null,0.218334836704626,0.218334836704626,null,0.218334836704626,0,null,0.218334836704626,0.218334836704626,null,0.218334836704626,0,null,0.541009873099094,0.541009873099094,null,0.541009873099094,0.267138094706666,null,0.267138094706666,0.267138094706666,null,0.267138094706666,0.214738244455064,null,0.214738244455064,0.214738244455064,null,0.214738244455064,0,null,0.214738244455064,0.214738244455064,null,0.214738244455064,0.134519382805207,null,0.134519382805207,0.134519382805207,null,0.134519382805207,0.087100262626233,null,0.087100262626233,0.087100262626233,null,0.087100262626233,0,null,0.087100262626233,0.087100262626233,null,0.087100262626233,0,null,0.134519382805207,0.134519382805207,null,0.134519382805207,0,null,0.267138094706666,0.267138094706666,null,0.267138094706666,0],"y":[27.140625,24.03125,null,24.03125,24.03125,null,24.03125,21.5,null,21.5,21.5,null,21.5,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,21.5,22.5,null,22.5,22.5,null,22.5,22,null,22,22,null,22.5,23,null,23,23,null,24.03125,26.5625,null,26.5625,26.5625,null,26.5625,25.125,null,25.125,25.125,null,25.125,24,null,24,24,null,25.125,26.25,null,26.25,26.25,null,26.25,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,26.25,27,null,27,27,null,26.5625,28,null,28,28],"text":["y: 0.99692696","y: 0.99692696",null,"y: 0.99692696","y: 0.99692696",null,"y: 0.54100987","y: 0.54100987",null,"y: 0.54100987","y: 0.54100987",null,"y: 0.31611734","y: 0.31611734",null,"y: 0.31611734","y: 0.31611734",null,"y: 0.12069883","y: 0.12069883",null,"y: 0.12069883","y: 0.12069883",null,"y: 0.12069883","y: 0.12069883",null,"y: 0.12069883","y: 0.12069883",null,"y: 0.31611734","y: 0.31611734",null,"y: 0.31611734","y: 0.31611734",null,"y: 0.21833484","y: 0.21833484",null,"y: 0.21833484","y: 0.21833484",null,"y: 0.21833484","y: 0.21833484",null,"y: 0.21833484","y: 0.21833484",null,"y: 0.54100987","y: 0.54100987",null,"y: 0.54100987","y: 0.54100987",null,"y: 0.26713809","y: 0.26713809",null,"y: 0.26713809","y: 0.26713809",null,"y: 0.21473824","y: 0.21473824",null,"y: 0.21473824","y: 0.21473824",null,"y: 0.21473824","y: 0.21473824",null,"y: 0.21473824","y: 0.21473824",null,"y: 0.13451938","y: 0.13451938",null,"y: 0.13451938","y: 0.13451938",null,"y: 0.08710026","y: 0.08710026",null,"y: 0.08710026","y: 0.08710026",null,"y: 0.08710026","y: 0.08710026",null,"y: 0.08710026","y: 0.08710026",null,"y: 0.13451938","y: 0.13451938",null,"y: 0.13451938","y: 0.13451938",null,"y: 0.26713809","y: 0.26713809",null,"y: 0.26713809","y: 0.26713809"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(199,167,108,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.34299341247493,1.34299341247493,null,1.34299341247493,0.965120668390196,null,0.965120668390196,0.965120668390196,null,0.965120668390196,0.257060389799351,null,0.257060389799351,0.257060389799351,null,0.257060389799351,0,null,0.257060389799351,0.257060389799351,null,0.257060389799351,0,null,0.965120668390196,0.965120668390196,null,0.965120668390196,0.502441143392568,null,0.502441143392568,0.502441143392568,null,0.502441143392568,0.386154070923752,null,0.386154070923752,0.386154070923752,null,0.386154070923752,0,null,0.386154070923752,0.386154070923752,null,0.386154070923752,0,null,0.502441143392568,0.502441143392568,null,0.502441143392568,0],"y":[46.10546875,52.875,null,52.875,52.875,null,52.875,51.5,null,51.5,51.5,null,51.5,51,null,51,51,null,51.5,52,null,52,52,null,52.875,54.25,null,54.25,54.25,null,54.25,53.5,null,53.5,53.5,null,53.5,53,null,53,53,null,53.5,54,null,54,54,null,54.25,55,null,55,55],"text":["y: 1.34299341","y: 1.34299341",null,"y: 1.34299341","y: 1.34299341",null,"y: 0.96512067","y: 0.96512067",null,"y: 0.96512067","y: 0.96512067",null,"y: 0.25706039","y: 0.25706039",null,"y: 0.25706039","y: 0.25706039",null,"y: 0.25706039","y: 0.25706039",null,"y: 0.25706039","y: 0.25706039",null,"y: 0.96512067","y: 0.96512067",null,"y: 0.96512067","y: 0.96512067",null,"y: 0.50244114","y: 0.50244114",null,"y: 0.50244114","y: 0.50244114",null,"y: 0.38615407","y: 0.38615407",null,"y: 0.38615407","y: 0.38615407",null,"y: 0.38615407","y: 0.38615407",null,"y: 0.38615407","y: 0.38615407",null,"y: 0.50244114","y: 0.50244114",null,"y: 0.50244114","y: 0.50244114"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(205,153,216,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25793496112615,1.25793496112615,null,1.25793496112615,0.866693379469397,null,0.866693379469397,0.866693379469397,null,0.866693379469397,0.549970313591416,null,0.549970313591416,0.549970313591416,null,0.549970313591416,0.378856666604982,null,0.378856666604982,0.378856666604982,null,0.378856666604982,0,null,0.378856666604982,0.378856666604982,null,0.378856666604982,0,null,0.549970313591416,0.549970313591416,null,0.549970313591416,0.353953508665767,null,0.353953508665767,0.353953508665767,null,0.353953508665767,0.242987480317126,null,0.242987480317126,0.242987480317126,null,0.242987480317126,0.184843448502153,null,0.184843448502153,0.184843448502153,null,0.184843448502153,0,null,0.184843448502153,0.184843448502153,null,0.184843448502153,0.129135319205484,null,0.129135319205484,0.129135319205484,null,0.129135319205484,0,null,0.129135319205484,0.129135319205484,null,0.129135319205484,0,null,0.242987480317126,0.242987480317126,null,0.242987480317126,0.136933215763799,null,0.136933215763799,0.136933215763799,null,0.136933215763799,0,null,0.136933215763799,0.136933215763799,null,0.136933215763799,0,null,0.353953508665767,0.353953508665767,null,0.353953508665767,0,null,0.866693379469397,0.866693379469397,null,0.866693379469397,0.794588376092913,null,0.794588376092913,0.794588376092913,null,0.794588376092913,0,null,0.794588376092913,0.794588376092913,null,0.794588376092913,0.390382037806456,null,0.390382037806456,0.390382037806456,null,0.390382037806456,0,null,0.390382037806456,0.390382037806456,null,0.390382037806456,0.356394200943233,null,0.356394200943233,0.356394200943233,null,0.356394200943233,0,null,0.356394200943233,0.356394200943233,null,0.356394200943233,0.328491042016268,null,0.328491042016268,0.328491042016268,null,0.328491042016268,0.173936070658795,null,0.173936070658795,0.173936070658795,null,0.173936070658795,0.126862027190533,null,0.126862027190533,0.126862027190533,null,0.126862027190533,0.0940416847602238,null,0.0940416847602238,0.0940416847602238,null,0.0940416847602238,0,null,0.0940416847602238,0.0940416847602238,null,0.0940416847602238,0,null,0.126862027190533,0.126862027190533,null,0.126862027190533,0,null,0.173936070658795,0.173936070658795,null,0.173936070658795,0,null,0.328491042016268,0.328491042016268,null,0.328491042016268,0.198085028641062,null,0.198085028641062,0.198085028641062,null,0.198085028641062,0,null,0.198085028641062,0.198085028641062,null,0.198085028641062,0.103148132846785,null,0.103148132846785,0.103148132846785,null,0.103148132846785,0,null,0.103148132846785,0.103148132846785,null,0.103148132846785,0.0534925743883374,null,0.0534925743883374,0.0534925743883374,null,0.0534925743883374,0,null,0.0534925743883374,0.0534925743883374,null,0.0534925743883374,0],"y":[17.15625,7.171875,null,7.171875,7.171875,null,7.171875,4.03125,null,4.03125,4.03125,null,4.03125,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,4.03125,6.5625,null,6.5625,6.5625,null,6.5625,5.125,null,5.125,5.125,null,5.125,3.75,null,3.75,3.75,null,3.75,3,null,3,3,null,3.75,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,5.125,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,6.5625,8,null,8,8,null,7.171875,10.3125,null,10.3125,10.3125,null,10.3125,9,null,9,9,null,10.3125,11.625,null,11.625,11.625,null,11.625,10,null,10,10,null,11.625,13.25,null,13.25,13.25,null,13.25,11,null,11,11,null,13.25,15.5,null,15.5,15.5,null,15.5,14.125,null,14.125,14.125,null,14.125,13.25,null,13.25,13.25,null,13.25,12.5,null,12.5,12.5,null,12.5,12,null,12,12,null,12.5,13,null,13,13,null,13.25,14,null,14,14,null,14.125,15,null,15,15,null,15.5,16.875,null,16.875,16.875,null,16.875,16,null,16,16,null,16.875,17.75,null,17.75,17.75,null,17.75,17,null,17,17,null,17.75,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19],"text":["y: 1.25793496","y: 1.25793496",null,"y: 1.25793496","y: 1.25793496",null,"y: 0.86669338","y: 0.86669338",null,"y: 0.86669338","y: 0.86669338",null,"y: 0.54997031","y: 0.54997031",null,"y: 0.54997031","y: 0.54997031",null,"y: 0.37885667","y: 0.37885667",null,"y: 0.37885667","y: 0.37885667",null,"y: 0.37885667","y: 0.37885667",null,"y: 0.37885667","y: 0.37885667",null,"y: 0.54997031","y: 0.54997031",null,"y: 0.54997031","y: 0.54997031",null,"y: 0.35395351","y: 0.35395351",null,"y: 0.35395351","y: 0.35395351",null,"y: 0.24298748","y: 0.24298748",null,"y: 0.24298748","y: 0.24298748",null,"y: 0.18484345","y: 0.18484345",null,"y: 0.18484345","y: 0.18484345",null,"y: 0.18484345","y: 0.18484345",null,"y: 0.18484345","y: 0.18484345",null,"y: 0.12913532","y: 0.12913532",null,"y: 0.12913532","y: 0.12913532",null,"y: 0.12913532","y: 0.12913532",null,"y: 0.12913532","y: 0.12913532",null,"y: 0.24298748","y: 0.24298748",null,"y: 0.24298748","y: 0.24298748",null,"y: 0.13693322","y: 0.13693322",null,"y: 0.13693322","y: 0.13693322",null,"y: 0.13693322","y: 0.13693322",null,"y: 0.13693322","y: 0.13693322",null,"y: 0.35395351","y: 0.35395351",null,"y: 0.35395351","y: 0.35395351",null,"y: 0.86669338","y: 0.86669338",null,"y: 0.86669338","y: 0.86669338",null,"y: 0.79458838","y: 0.79458838",null,"y: 0.79458838","y: 0.79458838",null,"y: 0.79458838","y: 0.79458838",null,"y: 0.79458838","y: 0.79458838",null,"y: 0.39038204","y: 0.39038204",null,"y: 0.39038204","y: 0.39038204",null,"y: 0.39038204","y: 0.39038204",null,"y: 0.39038204","y: 0.39038204",null,"y: 0.35639420","y: 0.35639420",null,"y: 0.35639420","y: 0.35639420",null,"y: 0.35639420","y: 0.35639420",null,"y: 0.35639420","y: 0.35639420",null,"y: 0.32849104","y: 0.32849104",null,"y: 0.32849104","y: 0.32849104",null,"y: 0.17393607","y: 0.17393607",null,"y: 0.17393607","y: 0.17393607",null,"y: 0.12686203","y: 0.12686203",null,"y: 0.12686203","y: 0.12686203",null,"y: 0.09404168","y: 0.09404168",null,"y: 0.09404168","y: 0.09404168",null,"y: 0.09404168","y: 0.09404168",null,"y: 0.09404168","y: 0.09404168",null,"y: 0.12686203","y: 0.12686203",null,"y: 0.12686203","y: 0.12686203",null,"y: 0.17393607","y: 0.17393607",null,"y: 0.17393607","y: 0.17393607",null,"y: 0.32849104","y: 0.32849104",null,"y: 0.32849104","y: 0.32849104",null,"y: 0.19808503","y: 0.19808503",null,"y: 0.19808503","y: 0.19808503",null,"y: 0.19808503","y: 0.19808503",null,"y: 0.19808503","y: 0.19808503",null,"y: 0.10314813","y: 0.10314813",null,"y: 0.10314813","y: 0.10314813",null,"y: 0.10314813","y: 0.10314813",null,"y: 0.10314813","y: 0.10314813",null,"y: 0.05349257","y: 0.05349257",null,"y: 0.05349257","y: 0.05349257",null,"y: 0.05349257","y: 0.05349257",null,"y: 0.05349257","y: 0.05349257"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.73098854685372,1.73098854685372,null,1.73098854685372,1.25793496112615,null,1.25793496112615,1.25793496112615,null,1.25793496112615,0.996926956772014,null,1.73098854685372,1.73098854685372,null,1.73098854685372,1.34299341247493,null,1.34299341247493,1.34299341247493,null,1.34299341247493,1.03236023849479],"y":[31.630859375,17.15625,null,17.15625,17.15625,null,17.15625,27.140625,null,27.140625,27.140625,null,31.630859375,46.10546875,null,46.10546875,46.10546875,null,46.10546875,39.3359375,null,39.3359375,39.3359375],"text":["y: 1.73098855","y: 1.73098855",null,"y: 1.73098855","y: 1.73098855",null,"y: 1.25793496","y: 1.25793496",null,"y: 1.25793496","y: 1.25793496",null,"y: 1.73098855","y: 1.73098855",null,"y: 1.73098855","y: 1.73098855",null,"y: 1.34299341","y: 1.34299341",null,"y: 1.34299341","y: 1.34299341"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.73098854685372,1.25793496112615,0.866693379469397,0.549970313591416,0.378856666604982,0,0,0.353953508665767,0.242987480317126,0.184843448502153,0,0.129135319205484,0,0,0.136933215763799,0,0,0,0.794588376092913,0,0.390382037806456,0,0.356394200943233,0,0.328491042016268,0.173936070658795,0.126862027190533,0.0940416847602238,0,0,0,0,0.198085028641062,0,0.103148132846785,0,0.0534925743883374,0,0,0.996926956772014,0.541009873099094,0.316117336171604,0.120698829805239,0,0,0.218334836704626,0,0,0.267138094706666,0.214738244455064,0,0.134519382805207,0.087100262626233,0,0,0,0,0.510058484735049,0.400793725724871,0,0,0,1.34299341247493,1.03236023849479,0.748863080520009,0,0.414529663168362,0.221473595612978,0.172807756442938,0,0,0,0.225517840791032,0,0,0.651849875658604,0.461988387623568,0.243783841165056,0.146641385028952,0,0,0,0.350134103756468,0.244447910748327,0,0.215900883474592,0,0.139199471226951,0,0,0.173101097562283,0,0,0.437952653150223,0.364946528637733,0,0,0.19447415233757,0,0,0.965120668390196,0.257060389799351,0,0,0.502441143392568,0.386154070923752,0,0,0],"y":[31.630859375,17.15625,7.171875,4.03125,1.5,1,2,6.5625,5.125,3.75,3,4.5,4,5,6.5,6,7,8,10.3125,9,11.625,10,13.25,11,15.5,14.125,13.25,12.5,12,13,14,15,16.875,16,17.75,17,18.5,18,19,27.140625,24.03125,21.5,20.5,20,21,22.5,22,23,26.5625,25.125,24,26.25,25.5,25,26,27,28,30.25,29.5,29,30,31,46.10546875,39.3359375,33.6875,32,35.375,34.25,33.5,33,34,35,36.5,36,37,44.984375,41.46875,39.25,38.5,38,39,40,43.6875,41.875,41,42.75,42,43.5,43,44,45.5,45,46,48.5,47.5,47,48,49.5,49,50,52.875,51.5,51,52,54.25,53.5,53,54,55],"text":["y: 1.73098855","y: 1.25793496","y: 0.86669338","y: 0.54997031","y: 0.37885667","y: 0.00000000","y: 0.00000000","y: 0.35395351","y: 0.24298748","y: 0.18484345","y: 0.00000000","y: 0.12913532","y: 0.00000000","y: 0.00000000","y: 0.13693322","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.79458838","y: 0.00000000","y: 0.39038204","y: 0.00000000","y: 0.35639420","y: 0.00000000","y: 0.32849104","y: 0.17393607","y: 0.12686203","y: 0.09404168","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.19808503","y: 0.00000000","y: 0.10314813","y: 0.00000000","y: 0.05349257","y: 0.00000000","y: 0.00000000","y: 0.99692696","y: 0.54100987","y: 0.31611734","y: 0.12069883","y: 0.00000000","y: 0.00000000","y: 0.21833484","y: 0.00000000","y: 0.00000000","y: 0.26713809","y: 0.21473824","y: 0.00000000","y: 0.13451938","y: 0.08710026","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.51005848","y: 0.40079373","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 1.34299341","y: 1.03236024","y: 0.74886308","y: 0.00000000","y: 0.41452966","y: 0.22147360","y: 0.17280776","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.22551784","y: 0.00000000","y: 0.00000000","y: 0.65184988","y: 0.46198839","y: 0.24378384","y: 0.14664139","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.35013410","y: 0.24444791","y: 0.00000000","y: 0.21590088","y: 0.00000000","y: 0.13919947","y: 0.00000000","y: 0.00000000","y: 0.17310110","y: 0.00000000","y: 0.00000000","y: 0.43795265","y: 0.36494653","y: 0.00000000","y: 0.00000000","y: 0.19447415","y: 0.00000000","y: 0.00000000","y: 0.96512067","y: 0.25706039","y: 0.00000000","y: 0.00000000","y: 0.50244114","y: 0.38615407","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"automargin":true,"type":"linear","autorange":false,"range":[0.5,5.5],"tickmode":"array","ticktext":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":6.6417600664176},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"ICT Indicators","hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1.73098854685372],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5"],"tickvals":[0,0.5,1,1.5],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":null,"family":null,"size":0}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,55.5],"tickmode":"array","ticktext":["Mabein","Monghpyak","Lawksawk","Nawnghkio","Nyaungshwe","Mongmit","Pekon","Pindaya","Ywangan","Namtu","Kutkai","Hopong","Hsipaw","Pinlaung","Monghsu","Hsihseng","Tangyan","Kyethi","Namhsan","Matman","Manton","Mongkaing","Mawkmai","Mongkhet","Mongyai","Mongping","Mongton","Monghsat","Narphan","Pangwaun","Konkyan","Kunlong","Hopang","Mongmao","Mongyang","Mongyawng","Namhkan","Hseni","Kalaw","Langkho","Laihka","Kunhing","Kyaukme","Nansang","Mongnai","Loilen","Pangsang","Mongpan","Kengtung","Lashio","Taunggyi","Tachileik","Muse","Mongla","Laukkaing"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],"categoryorder":"array","categoryarray":["Mabein","Monghpyak","Lawksawk","Nawnghkio","Nyaungshwe","Mongmit","Pekon","Pindaya","Ywangan","Namtu","Kutkai","Hopong","Hsipaw","Pinlaung","Monghsu","Hsihseng","Tangyan","Kyethi","Namhsan","Matman","Manton","Mongkaing","Mawkmai","Mongkhet","Mongyai","Mongping","Mongton","Monghsat","Narphan","Pangwaun","Konkyan","Kunlong","Hopang","Mongmao","Mongyang","Mongyawng","Namhkan","Hseni","Kalaw","Langkho","Laihka","Kunhing","Kyaukme","Nansang","Mongnai","Loilen","Pangsang","Mongpan","Kengtung","Lashio","Taunggyi","Tachileik","Muse","Mongla","Laukkaing"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":5.31340805313408},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Townships of Shan State","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":60,"r":null,"b":35.0684931506849,"l":200},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Geographic Segmentation of Shan State by ICT indicators"},"attrs":{"b5a512f4c960":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"},"b5a53f2b44f1":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"scatter"},"b5a531bb4a9d":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="mapping-the-clusters-formed" class="level3">
<h3 class="anchored" data-anchor-id="mapping-the-clusters-formed">5.4.6 Mapping the clusters formed</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Convert groups list to a matrix and append to shan_sf</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_cluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The choropleth map above reveals the clusters are very fragmented. The is one of the major limitation when non-spatial clustering algorithm such as hierarchical cluster analysis method is used.</p>
</section>
</section>
</section>
<section id="spatially-constrained-clustering-skater-approach" class="level1">
<h1>6.0 Spatially Constrained Clustering: SKATER approach</h1>
<section id="converting-into-spatialpolygonsdataframe" class="level2">
<h2 class="anchored" data-anchor-id="converting-into-spatialpolygonsdataframe">6.1 Converting into SpatialPolygonsDataFrame</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>shan_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(shan_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-neighbour-list" class="level2">
<h2 class="anchored" data-anchor-id="computing-neighbour-list">6.2 Computing Neighbour List</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>shan.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(shan_sp)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  8  9 19  5  4  4  1 
5 least connected regions:
13 25 31 36 54 with 2 links
1 most connected region:
52 with 9 links</code></pre>
</div>
</div>
<p>Plot neighbor list object, with coordinates applied to the original shan_sp (to extract the centroids of the polygons)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan.nb, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="computing-minimum-spanning-tree" class="level2">
<h2 class="anchored" data-anchor-id="computing-minimum-spanning-tree">6.3 Computing minimum spanning tree</h2>
<section id="calculating-edge-costs" class="level3">
<h3 class="anchored" data-anchor-id="calculating-edge-costs">6.3.1 Calculating edge costs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>lcosts <span class="ot">&lt;-</span> <span class="fu">nbcosts</span>(shan.nb, shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For each observation, this gives the pairwise dissimilarity between its values on the five variables and the values for the neighbouring observation (from the neighbour list). Basically, this is the notion of a generalised weight for a spatial weights matrix.</p>
<p>Incorporate into weights object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>shan.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(shan.nb, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                   lcosts, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"B"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 55 
Number of nonzero links: 264 
Percentage nonzero weights: 8.727273 
Average number of links: 4.8 
Link number distribution:

 2  3  4  5  6  7  8  9 
 5  8  9 19  5  4  4  1 
5 least connected regions:
13 25 31 36 54 with 2 links
1 most connected region:
52 with 9 links

Weights style: B 
Weights constants summary:
   n   nn       S0       S1        S2
B 55 3025 74067.64 54827108 495369982</code></pre>
</div>
</div>
</section>
<section id="computing-minimum-spanning-tree-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-minimum-spanning-tree-1">6.3.2 Computing minimum spanning tree</h3>
<p>Minimum spanning tree is computed by mean of the <a href="https://r-spatial.github.io/spdep/reference/mstree.html"><em>mstree()</em></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>shan.mst <span class="ot">&lt;-</span> <span class="fu">mstree</span>(shan.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check class and dimension</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mst"    "matrix"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54  3</code></pre>
</div>
</div>
<p>Note that the dimension is 54 and not 55. This is because the minimum spanning tree consists on n-1 edges (links) in order to traverse all the nodes.</p>
<p><strong>View</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]      [,3]
[1,]   54   50 130.86698
[2,]   54   53 139.31874
[3,]   53   51  95.66782
[4,]   51   52 161.25991
[5,]   52   31  77.88441
[6,]   31   29 143.54182</code></pre>
</div>
</div>
<p>Plot - include observation numbers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mst</span>(shan.mst, </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="computing-spatially-constrained-clusters-using-skater-method" class="level2">
<h2 class="anchored" data-anchor-id="computing-spatially-constrained-clusters-using-skater-method">6.4 Computing spatially constrained clusters using SKATER method</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>clust6 <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">skater</span>(<span class="at">edges =</span> shan.mst[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> shan_ict, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"euclidean"</span>, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncuts =</span> <span class="dv">5</span>) <span class="co">#n clusters - 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>View</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(clust6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 8
 $ groups      : num [1:55] 3 3 2 2 2 2 2 3 3 3 ...
 $ edges.groups:List of 6
  ..$ :List of 3
  .. ..$ node: num [1:12] 29 31 52 51 35 14 53 54 55 36 ...
  .. ..$ edge: num [1:11, 1:3] 35 52 51 14 54 54 53 51 29 31 ...
  .. ..$ ssw : num 1790
  ..$ :List of 3
  .. ..$ node: num [1:18] 25 7 4 22 6 17 24 15 20 12 ...
  .. ..$ edge: num [1:17, 1:3] 4 6 17 20 15 22 15 7 24 4 ...
  .. ..$ ssw : num 3475
  ..$ :List of 3
  .. ..$ node: num [1:14] 45 42 9 19 8 23 28 2 46 18 ...
  .. ..$ edge: num [1:13, 1:3] 42 28 19 23 45 9 23 2 23 8 ...
  .. ..$ ssw : num 1850
  ..$ :List of 3
  .. ..$ node: num [1:9] 49 44 48 39 43 37 47 41 40
  .. ..$ edge: num [1:8, 1:3] 39 44 37 48 43 47 41 47 37 48 ...
  .. ..$ ssw : num 905
  ..$ :List of 3
  .. ..$ node: num 11
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
  ..$ :List of 3
  .. ..$ node: num 38
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
 $ not.prune   : NULL
 $ candidates  : int [1:6] 1 2 3 4 5 6
 $ ssto        : num 12665
 $ ssw         : num [1:6] 12665 10593 9581 8855 8431 ...
 $ crit        : num [1:2] 1 Inf
 $ vec.crit    : num [1:55] 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, "class")= chr "skater"</code></pre>
</div>
</div>
<p>The most interesting component of this list structure is the groups vector containing the labels of the cluster to which each observation belongs (as before, the label itself is arbitary). This is followed by a detailed summary for each of the clusters in the edges.groups list. Sum of squares measures are given as ssto for the total and ssw to show the effect of each of the cuts on the overall criterion.</p>
<p>Check cluster assignment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ccs6 <span class="ot">&lt;-</span> clust6<span class="sc">$</span>groups</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>ccs6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3 3 2 2 2 2 2 3 3 3 5 2 1 1 2 2 2 3 3 2 3 2 3 2 2 2 2 3 1 3 1 2 2 2 1 1 4 6
[39] 4 4 4 3 4 4 3 3 4 4 4 1 1 1 1 1 1</code></pre>
</div>
</div>
<section id="plot-pruned-tree" class="level4">
<h4 class="anchored" data-anchor-id="plot-pruned-tree"><strong>Plot pruned tree</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clust6, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span>.<span class="dv">7</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">groups.colors=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"blue"</span>, <span class="st">"brown"</span>, <span class="st">"pink"</span>),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="visualising-the-clusters-in-choropleth-map" class="level2">
<h2 class="anchored" data-anchor-id="visualising-the-clusters-in-choropleth-map">6.5 Visualising the clusters in choropleth map</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>groups_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clust6<span class="sc">$</span>groups)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>shan_sf_spatialcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_cluster, <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">SP_CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.factor.groups_mat.</span><span class="st">`</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_spatialcluster, <span class="st">"SP_CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>View hierarchical clustering and spatially constrained hierarchical clustering maps</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>hclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_cluster,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"CLUSTER"</span>) <span class="sc">+</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>shclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_spatialcluster,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SP_CLUSTER"</span>) <span class="sc">+</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(hclust.map, shclust.map,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="spatially-constrained-clustering-clustgeo-method" class="level1">
<h1>7.0 Spatially Constrained Clustering: ClustGeo Method</h1>
<p>The algorithm uses two dissimilarity matrices D0 and D1 along with a mixing parameter alpha, whereby the value of alpha must be a real number between [0, 1]. D0 can be non-Euclidean and the weights of the observations can be non-uniform. It gives the dissimilarities in the <strong>attribute/clustering variable space</strong>. D1, on the other hand, gives the dissimilarities in the <strong>constraint space</strong>. The criterion minimised at each stage is a convex combination of the homogeneity criterion calculated with D0 and the homogeneity criterion calculated with D1.</p>
<p>The idea is then to determine a value of alpha which increases the spatial contiguity without deteriorating too much the quality of the solution based on the variables of interest.</p>
<section id="ward-like-hierarchical-clustering-clustgeo" class="level2">
<h2 class="anchored" data-anchor-id="ward-like-hierarchical-clustering-clustgeo">7.1 Ward-like hierarchical clustering: ClustGeo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>nongeo_cluster <span class="ot">&lt;-</span> <span class="fu">hclustgeo</span>(proxmat) <span class="co">#has to be type dist</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nongeo_cluster, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(nongeo_cluster, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="mapping-the-clusters-formed-1" class="level3">
<h3 class="anchored" data-anchor-id="mapping-the-clusters-formed-1">7.1.1 Mapping the clusters formed</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(nongeo_cluster, <span class="at">k=</span><span class="dv">6</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>shan_sf_ngeo_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_ngeo_cluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="spatially-constrained-hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="spatially-constrained-hierarchical-clustering">7.2 Spatially Constrained Hierarchical Clustering</h2>
<p>Derive spatial distance matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(shan_sf, shan_sf)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>distmat <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist) <span class="co">#convert df to dist</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Choose a suitable value for the mixing parameter alpha</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">choicealpha</span>(proxmat, distmat, <span class="at">range.alpha =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">K=</span><span class="dv">6</span>, <span class="at">graph =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>alpha = 0.3 will be used</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>clustG <span class="ot">&lt;-</span> <span class="fu">hclustgeo</span>(proxmat, distmat, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Derive cluster object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(clustG, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Join with shan_sf polygon feature</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>shan_sf_Gcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Plot</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_Gcluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="visual-interpretation-of-clusters" class="level1">
<h1>8.0 Visual Interpretation of Clusters</h1>
<section id="visualising-individual-clustering-variable" class="level2">
<h2 class="anchored" data-anchor-id="visualising-individual-clustering-variable">8.1 Visualising individual clustering variable</h2>
<p>Clustering variable - RADIO_PR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shan_sf_ngeo_cluster,</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> CLUSTER, <span class="at">y =</span> RADIO_PR)) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The boxplot reveals Cluster 3 displays the highest mean Radio Ownership Per Thousand Household. This is followed by Cluster 2, 1, 4, 6 and 5.</p>
</section>
<section id="multivariate-visualisation" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-visualisation">8.2 Multivariate Visualisation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> shan_sf_ngeo_cluster, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">17</span><span class="sc">:</span><span class="dv">21</span>), </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.2</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Multiple Parallel Coordinates Plots of ICT Variables by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> CLUSTER) <span class="sc">+</span> </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hands-on_ex09_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The parallel coordinate plot above reveals that households in Cluster 4 townships tend to own the highest number of TV and mobile-phone. On the other hand, households in Cluster 5 tends to own the lowest of all the five ICT.</p>
<p><strong>Summary</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>shan_sf_ngeo_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CLUSTER) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_RADIO_PR =</span> <span class="fu">mean</span>(RADIO_PR),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_TV_PR =</span> <span class="fu">mean</span>(TV_PR),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_LLPHONE_PR =</span> <span class="fu">mean</span>(LLPHONE_PR),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_MPHONE_PR =</span> <span class="fu">mean</span>(MPHONE_PR),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_COMPUTER_PR =</span> <span class="fu">mean</span>(COMPUTER_PR))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  CLUSTER mean_RADIO_PR mean_TV_PR mean_LLPHONE_PR mean_MPHONE_PR mean_COMPUTE…¹
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
1 1               122.        329.           29.1           178.           10.7 
2 2               296.        591.           44.2           380.           29.3 
3 3               181.        715.           94.3           620.           52.0 
4 4                84.8       472.           75.4           473.           18.5 
5 5               222.        508.           40.0           199.           17.3 
6 6               235.        204.            7.45           61.5           6.05
# … with abbreviated variable name ¹​mean_COMPUTER_PR</code></pre>
</div>
</div>
<p><br>
</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>